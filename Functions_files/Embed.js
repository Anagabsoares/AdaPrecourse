"use strict";(Panopto=Panopto||{}).PlayerJsFlowplayerAdapter=function(e,t){(t=t||{}).loadCallback=t.loadCallback||$.noop;var o=new playerjs.Receiver(["play","pause","timeupdate","seeked","ended","error"],["play","pause","mute","unmute","getDuration","getPaused","getMuted","getVolume","setVolume","getCurrentTime","setCurrentTime","getLoop","setLoop"]);o.on("play",(function(){e.ready?_.defer((function(){e.resume()})):t.loadCallback()})),o.on("pause",(function(){_.defer((function(){e.pause()}))})),o.on("mute",(function(){e.mute(!0)})),o.on("unmute",(function(){e.mute(!1)})),o.on("getDuration",(function(t){e.ready?t(e.video.duration):e.on("ready",(function(){t(e.video.duration)}))})),o.on("getPaused",(function(t){t(e.paused)})),o.on("getMuted",(function(t){t(e.muted)})),o.on("getVolume",(function(t){t(100*e.volumeLevel)})),o.on("setVolume",(function(t){e.volume(t/100)})),o.on("getCurrentTime",(function(t){t(e.video.time)})),o.on("setCurrentTime",(function(t){e.seek(t)}));var i=!1;return o.on("getLoop",(function(e){e(i)})),o.on("setLoop",(function(e){i=e})),e.on("ready",(function(){o.emit("play")})),e.on("pause",(function(){o.emit("pause")})),e.on("resume",(function(){o.emit("play")})),e.on("progress",(function(){o.eventListeners.timeupdate&&o.emit("timeupdate",{seconds:e.video.time,duration:e.video.duration})})),e.on("seek",(function(){o.emit("seeked")})),e.on("finish",(function(){o.emit("ended"),i&&e.resume()})),e.on("error",(function(){o.emit("error")})),o},(Panopto=Panopto||{}).Branding=Panopto.Branding||{};var renderBrandingStyleElement=$("<style />").appendTo("head");Panopto.Branding.createLogo=function(e,t,o){var i={svgUrl:Panopto.branding.svgLogo,pngUrl:t.png,width:t.svgWidth,height:t.svgHeight,mainLogoToolTip:Panopto.GlobalResources.Everything,customerLogoLink:Panopto.branding.siteLogoLink,cobrandLink:"https://www.panopto.com",cobrandString:Panopto.GlobalResources.PanoptoLogo_PoweredBy,listPageLink:PanoptoTS.StringHelpers.format("{0}/Pages/Sessions/List.aspx",Panopto.appRoot),linksEnabled:o},a=_.template($("#customerLogoTemplate").html())(i),n=_.template($("#panoptoLogoTemplate").html())(i);e.html(i.pngUrl&&-1===i.pngUrl.indexOf("_branding")?n:a)},Panopto.Branding.renderBrandingColors=function(e,t){var o,i,a,n=Panopto.Core.UI.Color.parse(e),r=n.toHex(),s=n.getSafety().toHex(),l=n.getSafety().multiply(.9).toHex(),c=n.getSafety().multiply(.8).toHex(),p=[{selector:".accent-color",styleChanges:["color: {0}","border-color: {0}"]},{selector:".selected.accent-left-border",styleChanges:["border-left-color: {0}"]},{selector:".content-table table .selected .highlight-cell",styleChanges:["background-color: {0}"]},{selector:".embedded-plugin#batchUpload #sessionList .session.selected .session-check.accent-button",styleChanges:["background-color: {0}"]},{selector:".accent-background",styleChanges:["background-color: {0}"]},{selector:".selected.accented-tab",styleChanges:["border-left-color: {0}"]},{selector:".MuiSwitch-root .Mui-checked .MuiIconButton-label",styleChanges:["color: {0}"]},{selector:".MuiSwitch-root .Mui-checked + .MuiSwitch-track",styleChanges:["background-color: {0}"]},{selector:".MuiSwitch-colorSecondary.Mui-checked",styleChanges:["color: {0}"]}],d=[{selector:".selected.accent-left-border a",styleChanges:["border-left-color: {0}"]},{selector:".selected .accent-button",styleChanges:["border-color: {0}"]},{selector:".selected.accented-tab",styleChanges:["background-color: {0}"]},{selector:".safety-accent-border",styleChanges:["border-color: {0}"]},{selector:".safety-background",styleChanges:["background-color: {0}"]},{selector:".safety-text",styleChanges:["color: {0}"]},{selector:".safety-accent-highlighted.highlighted .event-text",styleChanges:["color: {0}"]},{selector:".safety-accent-highlighted.editing .event-text",styleChanges:["color: {0}"]},{selector:".safety-accent-highlighted.highlighted .event-time",styleChanges:["color: {0}"]},{selector:".safety-accent-highlighted.editing .event-time",styleChanges:["color: {0}"]},{selector:".event-tab-pane .match",styleChanges:["color: {0}"]},{selector:".safety-border",styleChanges:["border-color: {0}"]},{selector:".colored-scroll-button",styleChanges:["color: {0}"]},{selector:".selected.branded-border",styleChanges:["border-color: {0}"]}];t?p.push({selector:".safety-accent-border-ifcustom",styleChanges:["border-color: {0}"]}):d.push({selector:".safety-accent-border-ifcustom",styleChanges:["border-color: {0}"]});var u=function(e,t){return{selector:e,styleChanges:[PanoptoTS.StringHelpers.format("background-color: {0}",t),PanoptoTS.StringHelpers.format("border-color: {0}",t)]}},h=".branded-button:hover",A=".branded-button:active";function m(e){_.each(e.styleChanges,(function(t){$.rule(e.selector+"{"+t+" !important}").appendTo(renderBrandingStyleElement)}))}function y(e,t){_.each(e,(function(e){m(e=function(e,t){return e.styleChanges=_.map(e.styleChanges,(function(e){return PanoptoTS.StringHelpers.format(e,t)})),e}(e,t))}))}Panopto.Core.Browser.isIE8||(h+=":not(.disabled)",A+=":not(.disabled)"),o=u(".branded-button",s),i=u(h,l),a=u(A,c),y(p,r),y(d,s),y([{selector:".embedded-plugin#batchUpload #sessionList .session.selected .session-check.accent-button:hover",styleChanges:["background-color: {0}"]},{selector:".embedded-plugin#batchUpload .create-upload:hover .create-upload-icon.image-accent-background",styleChanges:["background-color: {0}"]}],l),m(o),m(i),m(a);var v=function(e){if(!/^#[0-9a-f]{6}$/.test(e))return[];var t=e.substr(1,2),o=e.substr(3,2),i=e.substr(5,2);return[parseInt(t,16).toString(),parseInt(o,16).toString(),parseInt(i,16).toString()]}(r);[{selector:".MuiSwitch-colorSecondary.Mui-checked:hover",styleChanges:["background-color: {0}"],alpha:.04}].forEach((function(e){e.styleChanges=e.styleChanges.map((function(t){return PanoptoTS.StringHelpers.format(t,function(e){if(v.length&&!(e>1||e<0)){var t=e.toString();return"rgba("+v[0]+", "+v[1]+", "+v[2]+", "+t+")"}}(e.alpha))})),m(e)}))},Panopto.Branding.brandElements=function(e){var t=Panopto.Core.UI.Color.parse(e),o=t.toHex(),i=t.getSafety().toHex();Panopto.Branding.brandImageBackgrounds(".image-accent-background",".image-accent-background",o),Panopto.Branding.animateLoadingIndicator(i)},Panopto.Branding.animateLoadingIndicator=function(e){var t=Panopto.Core.Browser.isCssSupported("animation");Panopto.Core.UI.Components.spinner($("#loadingMessage"),t),Panopto.Core.UI.Components.spinner($("#primaryBuffering"),t),Panopto.Core.UI.Components.spinner($("#secondaryBuffering"),t),Panopto.Core.UI.Components.spinner($(".logging-out-spinner"),t),Panopto.Core.UI.Components.spinner($(".logging-in-spinner"),t),Panopto.Core.UI.Components.spinner($("#modalSpinner"),t),Panopto.Core.UI.Components.spinner($(".event-tab-spinner"),t),Panopto.Branding.brandImageBackgrounds(".branded-animation",".spinner-background",e),$("#navBar .browse-spinner #path").css("fill",e)},Panopto.Branding.brandImageBackground=function(e,t){-1!==t.indexOf("_branding")&&e.css("background-image","url("+t+")")},Panopto.Branding.brandImageBackgroundRule=function(e,t){var o=-1!==t.indexOf("_branding");return o&&$.rule(e+"{background-image: url("+t+") !important}").appendTo(renderBrandingStyleElement),o},Panopto.Branding.brandImageBackgrounds=function(e,t,o){var i=_.filter(_.map($(e),(function(e){var t=$(e).css("background-image");return t&&(t=t.replace(/^url|[\(\")]/g,"")),t})),(function(e){return"none"!==e})),a=i.length,n=function(e){e||$.rule(t+"{background-color:"+o+" !important}").appendTo(renderBrandingStyleElement)};n(a),_.each(i,(function(e){var t=new Image,o=function(){a--,n(a)};t.onload=o,t.onerror=o,t.src=e}))},function(e){!function(e){var t=function(){function t(e,t,o,i,a){this.blocked=e,this.userId=t,this.ownerId=o,this.signupUrl=i,this.resources=a,this.eventNamespace="quota-playback-modal",this._onToggle=new PanoptoCore.TypedCallback}return Object.defineProperty(t.prototype,"onToggle",{get:function(){return this._onToggle},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this;this.wrapper=$(t.template(this)),this.modal=this.wrapper.find(".quota-playback-modal"),this.wrapper.click((function(){e.blocked||e.hide()})),this.modal.click((function(e){e.stopPropagation()})),this.wrapper.hide(),$(window).resize((function(){e.modal.is(":visible")&&e.resize()}))},t.prototype.show=function(){var t,o=this;if(this.userId)t=this.userId===this.ownerId?new e.QuotaPlaybackModalDialogs.OwnerDialog(this.resources):new e.QuotaPlaybackModalDialogs.ViewerDialog(this.resources);else{var i=new e.QuotaPlaybackModalDialogs.AnonymousUserDialog(this.blocked,this.signupUrl,this.resources);i.onDismiss.add((function(){o.hide()})),t=i}t.render(),this.modal.contents().replaceWith(t.getElement()),this.wrapper.show(),this.resize(),$(window).on("resize."+this.eventNamespace,(function(){o.resize()})),this._onToggle.fire(!0)},t.prototype.hide=function(){this.wrapper.hide(),$(window).off("resize."+this.eventNamespace),this._onToggle.fire(!1)},t.prototype.fadeIn=function(){this.show(),this.wrapper.hide(),this.wrapper.fadeIn()},t.prototype.getElement=function(){return this.wrapper},t.prototype.resize=function(){this.modal.height(this.modal.find(".quota-dialog").height());var e=window.innerHeight/this.modal.height();this.modal.css({transform:"scale("+Math.min(1,e)+")"})},t.template=_.template("\n            <div class='quota-playback-modal-wrapper'>\n                <div class='quota-playback-modal'>\n                </div>\n            </div>\n        "),t}();e.QuotaPlaybackModal=t}(e.Controls||(e.Controls={}))}(PanoptoTS||(PanoptoTS={})),function(e){!function(e){var t=function(){function t(e,o,i,a,n,r,s){this.cookieService=e,this.container=o,this.resources=i,this.deliveryId=a,this.ownerId=n,this.userId=r,this.signupUrl=s,this.secondsListened=0,this._onToggle=new PanoptoCore.TypedCallback,this.quotaBlockedCookieName=t.quotaBlockedCookiePrefix+this.deliveryId}return Object.defineProperty(t.prototype,"onToggle",{get:function(){return this._onToggle},enumerable:!1,configurable:!0}),t.prototype.initialize=function(o){var i=this;this.overQuota=o,this.overQuota||this.setBlockedCookie(!1),this.blocked=this.getBlockedCookie(),this.overQuota&&(this.availableSeconds=this.blocked?0:t.playbackTeaseDuration),this.modal=new e.QuotaPlaybackModal(this.blocked,this.userId,this.ownerId,this.signupUrl,this.resources),this.modal.onToggle.add((function(e){i._onToggle.fire(e)})),this.modal.render(),this.container.append(this.modal.getElement()),window.setTimeout((function(){window.location.reload()}),864e5),this.blocked&&this.modal.show()},t.prototype.update=function(e){if(!this.userId&&!this.overQuota&&0===this.secondsListened&&e){var o=parseInt(this.cookieService.getCookie(t.signupViewedCookieName),10)||0;o%t.signupShowInterval==t.signupShowInterval-1&&this.modal.show(),this.cookieService.setCookie(t.signupViewedCookieName,o+1)}this.secondsListened+=e,this.blocked=void 0!==this.availableSeconds&&this.secondsListened>=this.availableSeconds,this.blocked&&(this.modal.blocked=this.blocked,this.modal.show(),this.setBlockedCookie(!0))},t.prototype.fadeInModalForAnonymous=function(){this.userId||this.modal.fadeIn()},t.prototype.setBlockedCookie=function(e){e?this.cookieService.setCookie(this.quotaBlockedCookieName,e):this.cookieService.deleteCookie(this.quotaBlockedCookieName)},t.prototype.getBlockedCookie=function(){return"true"===this.cookieService.getCookie(this.quotaBlockedCookieName)},t.playbackTeaseDuration=30,t.quotaBlockedCookiePrefix="quotaBlocked",t.signupViewedCookieName="signupViewed",t.signupShowInterval=5,t}();e.QuotaPlaybackTracker=t}(e.Controls||(e.Controls={}))}(PanoptoTS||(PanoptoTS={}));var Panopto,PanoptoTS,__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var a in t=arguments[o])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};!function(e){!function(t){var o=Panopto.Core.StringHelpers,i=Panopto.Core.Key,a=PanoptoCore.Logging.Logger,n=function(){function n(t,i,a){var r,s=this;this.deliveryService=i,this.webcastVersionService=a,this.iPhoneReturnFromFullscreenPlaying=!1,this.uniqueViewerId=null,this.downloadEnabled=!1,this.processingPingIntervalMsec=Panopto.features.embedProcessingStatusIntervalMsec,this.checkCopyrightNoticeRequirement=$.Deferred(),this.checkBlockingLTIQuiz=$.Deferred(),this.invocationRequested=!1,this.eventOverlayShown=!1,this.menuOpen=!1,this.nativeFullscreen=!1,this.vspSourceOverrideActive=!1,this._selectedCaptionSetting="selectedCaptionSetting",this.quizWarnHasShown=!1,this.handleEmbedApiCommand=function(t){switch(t.msg){case PanoptoViewer.EmbedApiMessagesToFrame.Play:s.resume();break;case PanoptoViewer.EmbedApiMessagesToFrame.Pause:s.pause();break;case PanoptoViewer.EmbedApiMessagesToFrame.Mute:s.mute(!0);break;case PanoptoViewer.EmbedApiMessagesToFrame.Unmute:s.mute(!1);break;case PanoptoViewer.EmbedApiMessagesToFrame.Speed:s.setSpeed(t.floatData);break;case PanoptoViewer.EmbedApiMessagesToFrame.Seek:s.seek(t.floatData);break;case PanoptoViewer.EmbedApiMessagesToFrame.Volume:s.setVolume(t.floatData);break;case PanoptoViewer.EmbedApiMessagesToFrame.Load:new e.Viewer.AutoPlayDetector({muted:s.startMuted,playsInline:!0,autoPlayRequested:!0}).detect().then((function(e){e||s.mute(!0),s.loadVideo()}));break;case PanoptoViewer.EmbedApiMessagesToFrame.Stop:s.stop();break;case PanoptoViewer.EmbedApiMessagesToFrame.CaptionsOn:if(s.nonNativeCaptionsAvailable){var o=!1;if(!isNaN(t.intData)){var i=s.initParams.AvailableLanguages[t.intData];s.timelineController&&i!==s.selectedCaption&&(s.getCaptions(s.deliveryId,s.inviteId,i).done((function(){return s.toggleCaptions(!0)})),o=!0),s.selectedCaption=i}o||s.toggleCaptions(!0)}break;case PanoptoViewer.EmbedApiMessagesToFrame.CaptionsOff:s.nonNativeCaptionsAvailable&&s.toggleCaptions(!1)}},this.circularLogger=new PanoptoCore.Logging.CircularBufferTransport({loglevel:PanoptoCore.Logging.LogLevel.Verbose,bufferSize:n.CircularLogBufferSize}),PanoptoCore.Logging.Logger.addTransport(this.circularLogger),this.initParams=t,this.sessionListUrl=Panopto.uriScheme+"://"+Panopto.webServerFQDN+Panopto.appRoot+"/Pages/Sessions/List.aspx",this.defaultThumbnailUrl=Panopto.cacheRoot+"/Images/no_thumbnail.svg",this.loginUrl=String.format(this.initParams.LoginUrl,encodeURIComponent(window.location.href));var l=o.parseQueryString(location.search,!0,!0);this.interactivity="none"===l.interactivity||"false"===l.interactivity?"none":"search"===l.interactivity?"search":"all",this.hideOverlay=o.parseBoolean(l.hideoverlay);var c=o.parseBoolean(l.remoteembed),p=l.remotehost,d=l.embedapiid,u="MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,h=!!$.browser.mobile||u,A=!!($.browser.ipad||$.browser.iphone||$.browser.ipod)||u,m=o.parseBoolean(l.iosapp),y=o.parseBoolean(l.androidapp),v=o.parseBoolean(l.videopreview),g=o.parseBoolean(l.panoptomobile),f=m||y||g,P=!(f||A&&!$.browser.safari),b=l.query,C=this.initParams.IsLiveBroadcast;this.isLiveBroadcast=C;var w=this.ensureMobileCompatibleManifest(this.initParams.VideoUrl),S=o.parseBoolean(l.advance),k=o.parseBoolean(l.autoplay)&&Panopto.features.autoPlayEnabled||S,T=!("showtitle"in l)||o.parseBoolean(l.showtitle),I=l.showbrand?o.parseBoolean(l.showbrand):Panopto.features.brandEmbedViewer;this.scormEnabled=l.isscorm;var E,D=(_.isUndefined(l.offerviewer)||o.parseBoolean(l.offerviewer)||Panopto.useFreeTrialTerminology)&&!o.parseBoolean(l.internal)&&(!h||Panopto.Core.Browser.inIframe()&&!Panopto.Core.Browser.fullscreenEnabled)&&!this.scormEnabled,V=D&&!l.outcome_did,R=l.start?parseFloat(l.start):void 0;l.outcome_did&&(E={outcomeId:l.outcome_did,oauthConsumerKey:l.oauth_consumer_key,outcomeServiceUrl:l.lis_outcome_service_url});var B,L=(_.isUndefined(l.autohide)||o.parseBoolean(l.autohide))&&!this.initParams.IsAudioOnly;B=_.isUndefined(l.flash)?_.isUndefined(l.htmlfirst)?this.initParams.MediaFileType===Panopto.Core.MediaFileType.mp4&&new RegExp(Panopto.embedFlashFallbackRegex).test(navigator.userAgent)||this.initParams.MediaFileType===Panopto.Core.MediaFileType.hls&&new RegExp(Panopto.features.hlsFlashFallbackRegex).test(navigator.userAgent):!o.parseBoolean(l.htmlfirst):o.parseBoolean(l.flash);var M=(Panopto.Core.Browser.fullscreenEnabled||A)&&!this.initParams.IsAudioOnly&&!f&&!this.hideOverlay,U=!!this.initParams.CaptionUrl&&this.initParams.CaptionUrl.length>0,O=PanoptoCore.CookieHelpers.getUserCookieField(Panopto.user.userKey,n.captionsCookieKey),F=_.isUndefined(l.captions)?void 0:o.parseBoolean(l.captions),x="boolean"==typeof O?O:"boolean"==typeof F?F:Panopto.captionSettings.enabledDefault,N=U&&x,q=!(C||$.browser.msie&&Panopto.Core.Browser.isWin7&&this.initParams.MediaFileType===Panopto.Core.MediaFileType.hls||Panopto.viewer.disableSeekAndVsp),H=PanoptoCore.CookieHelpers.getUserCookieField(Panopto.user.userKey,n.volumeCookieKey);"number"!=typeof H&&(H=n.maxVolume);var z=parseFloat(l.playspeed);z=q&&-1!==n.playbackSpeeds.indexOf(z)?z:PanoptoViewer.PlaySpeed.Normal;var Q=o.parseBoolean(l.starttourmuted),G=n.flowplayerGlobal.support.volume&&(0===H||Q),W=this.initParams.VRType>PanoptoViewer.MediaVRType.None,j=Panopto.Core.UI.Components.CopyrightNotice($("#copyrightNoticeContainer"),this.initParams.CopyrightNoticeText,this.initParams.CopyrightNoticeAutoDismissDuration);if(this.deliveryId=this.initParams.DeliveryId,this.sessionId=this.initParams.SessionId,this.playlistId=l.pid,this.playlistDeliveryId=l.id,this.inviteId=l.tid,this.videoUrl=w,this.isMobile=h,this.isIos=A,this.isIosApp=m,this.isAndroidApp=y,this.isReactNativeApp=g,this.isApp=f,this.downloadSupported=P,this.hasBackButton=this.isIosApp||this.isReactNativeApp,this.isVideoPreview=v,this.playlistAdvance=S,this.autoPlayRequested=k,this.startMuted=G,this.startTourMutedQuery=Q,this.showTitle=T,this.showBrand=I,this.showFullViewerLink=D,this.fullViewerLinkEnabled=V,this.ltiOutcomeConfig=E,this.autoHideRequested=L,this.isLiveBroadcast=C,this.preferFlash=B,this.fullscreenEnabled=M,this.nonNativeCaptionsAvailable=U,this.vspSupported=q,this.isVR=W,this.remoteEmbed=c,this.remoteHost=p,this.embedApiId=d,this.isLTIContext=l.outcome_did,this.enableMultistream=this.initParams.EnableEmbedMultistream&&!W,this.initParams.TrustBrowserNativeHls&&PanoptoViewer.PrimitivePlayerFactory.trustBrowserNativeHls(),this.defaultLayout=this.convertPodcastTypeToLayout(this.initParams.podcastLayout),this.startTime=R,this.initialVolume=H,this.initialPlaySpeed=z,this.initialSearchTerm=b,this.player=$("#player"),this.eventOverlayElement=$("#eventOverlay"),this.copyrightNotice=j,this.shouldDisplayCaptionsInitially=x,this.captionsDisplayed=N,this.userSettingService=PanoptoCore.UserSettingsService.getInstance(),this.nonNativeCaptionsAvailable&&(this.selectedCaption=this.userSettingService.getSetting(this._selectedCaptionSetting),this.availableLanguagesFriendly=null===(r=this.initParams.AvailableLanguages)||void 0===r?void 0:r.map((function(e){return e?PanoptoCore.ContentLanguageFriendly[PanoptoCore.ContentLanguage[e]]:Panopto.GlobalResources.Admin_Captions_NoLanguage})),-1===this.initParams.AvailableLanguages.indexOf(this.selectedCaption)&&(this.selectedCaption=this.initParams.AvailableLanguages[0])),Panopto.viewer.ultraHighScaleAnonymousWebcastMode)try{var K=window.crypto||window.msCrypto,Y=new Uint32Array(2),J=new Uint16Array(4);K.getRandomValues(Y),K.getRandomValues(J),this.uniqueViewerId=Y[0].toString(16)+"-"+J[0].toString(16)+"-"+J[1].toString(16)+"-"+J[2].toString(16)+"-"+J[3].toString(16)+Y[1].toString(16)}catch(e){this.uniqueViewerId="00000000-0000-0000-0000-000000000000"}this.configureOrientationListener(),this.deliveryRefreshTimer=new e.Viewer.Controls.DeliveryRefreshTimer(this.deliveryId,this.inviteId,!1,!0,!1,!1,Panopto.viewer.embedAndDeliveryInfoCDNFQDNOverride||null,this.uniqueViewerId,i,a,(function(t){return new e.Viewer.Data.Delivery(t)}),(function(e){s.setDelivery(e),s.checkForBlockingLTIQuiz(),s.render()}),(function(e){window.location.reload()}),(function(e){s.updateBroadcast(e)}),(function(){window.location.reload()}),(function(){s.render()})),$((function(){s.deliveryRefreshTimer.start()}))}return Object.defineProperty(n.prototype,"autoHideEnabled",{get:function(){var e=this.initParams.IsAudioOnly&&$(window).height()<n.hoverCaptionsMinHeight&&this.captionsDisplayed;return this.autoHideRequested||e},enumerable:!1,configurable:!0}),n.prototype.convertPodcastTypeToLayout=function(e){return void 0!==PanoptoViewer.PlayerLayoutMode[e]?e:PanoptoViewer.PlayerLayoutMode.Normal},n.prototype.getCaptions=function(e,t,o){var i=this,n=$.Deferred();return this.deliveryService.getCaptions(e,t,o,(function(e){var t=e.map((function(e){return{text:e.Caption||"",time:e.Time}})),r=PanoptoCore.ContentLanguage[o]||"[default language]";a.info("[Embed.ts] > Received "+t.length+" captions for "+r),i.timelineController&&t.length>0&&(n.resolve(t),i.timelineController.updateCaptions(t))}),(function(){a.error("[Embed.ts] > Failed to fetch captions"),n.reject()})),n.promise()},n.prototype.submitClientLog=function(){if(this.invocationId){var e={DeliveryParams:__assign(__assign({},this.delivery.serverModel),{InvocationId:this.invocationId}),Entries:this.circularLogger.retrieveLogs().map((function(e){return{Type:null,Position:null,Timestamp:null,Detail:e}}))};Panopto.Core.ServiceInterface.WCFRest.DataCS.submitViewerClientLog(e,(function(e){alert(Panopto.GlobalResources.ViewerPlus_LogsSent+e)}),(function(){alert(Panopto.GlobalResources.ViewerPlus_LogsError)}))}else a.warning("[Embed.ts] > Attempted to submit logs without an invocation ID")},n.prototype.setDelivery=function(e){var t=Panopto.Core.PlayResumption.calculateStartTime(e.lastViewingPosition,e.duration);this.delivery=e,this.downloadUrl=e.downloadUrl,this.downloadEnabled=!!this.downloadUrl&&this.downloadSupported,this.startTime=isNaN(this.startTime)?t:this.startTime,this.quizzes=_.filter(e.documents,(function(e){return e.isQuiz})),this.showFullViewerLink=this.showFullViewerLink&&!e.isPurgedEncode,e.completionPercentage&&this.reportPercentCompleted(e.completionPercentage)},n.prototype.reportPercentCompleted=function(e){Panopto.viewer.disableSeekAndVsp&&Panopto.viewer.enableSeekAndVspAfterPercentage>0&&Panopto.viewer.enableSeekAndVspAfterPercentage<e&&this.updateDisableSeekAndVsp(!1)},n.prototype.updateDisableSeekAndVsp=function(e){Panopto.viewer.disableSeekAndVsp!==e&&(Panopto.viewer.disableSeekAndVsp=e,Panopto.viewer.disableSeekAndVsp?this.preventUserSeek():this.enableUserSeek())},n.prototype.checkWebcastEnded=function(e){(this.delivery.broadcastInterrupted||this.delivery.broadcastEnded)&&e?($("#broadcastStatus").text(this.delivery.broadcastInterrupted?Panopto.GlobalResources.Embed_BroadcastInterrupted:Panopto.GlobalResources.Embed_BroadcastEnded),$("#broadcastStatusWrapper").toggle(!0)):$("#broadcastStatusWrapper").toggle(!1)},n.prototype.checkForApiStateChange=function(e){this.hasPlaybackRateChanged(e)&&(this.sendApiStateUpdate(PanoptoViewer.EmbedApiMessagesToParent.SpeedUpdate),this.sendReactNativeStateUpdate()),this.timelineState.paused!==e.paused&&(this.sendApiStateUpdate(PanoptoViewer.EmbedApiMessagesToParent.StateUpdate),this.sendReactNativeStateUpdate()),this.timelineState.timelinePosition===e.timelinePosition&&this.timelineState.muted===e.muted&&this.timelineState.volume===e.volume||(this.sendApiStateUpdate(void 0),this.sendReactNativeStateUpdate())},n.prototype.hasPlaybackRateChanged=function(e){return this.timelineState&&e.playbackRate!==this.timelineState.playbackRate},n.prototype.handleTimelineControllerStateChanged=function(e){var t=this.hasPlaybackRateChanged(e),o=this.timelineState;this.timelineState=e,this.checkForApiStateChange(o),t&&this.loggerSpeedChangeHandler&&this.loggerSpeedChangeHandler();var i=this.player.find(".mobile-transport-controls .play, .bottom-transport-controls .play"),r=Panopto.GlobalResources[e.paused?"Embed_Tooltip_Pause":"Embed_Tooltip_Play"];i.attr({title:r,"aria-label":r}),this.isLiveBroadcast&&this.isPositionAtTheEnd(e.timelinePosition,this.delivery.duration)&&this.checkWebcastEnded(e.paused);r=Panopto.GlobalResources[e.muted?"Embed_Muted":"Embed_Unmuted"];if($("#muteButton").attr("title",r),this.player.toggleClass("is-muted",e.muted),o.volume!==e.volume||o.muted!==e.muted){var s=e.muted?0:100*e.volume;this.setVolumeCookie(s),this.isMobile||($("#volumeSlider").slider("value",s),$("#volumeLevel").css("width",s+"%"))}if(this.player.toggleClass("is-playing",!e.paused),o.paused&&!e.paused&&this.showControls(n.playDisplayDuration),e.isBuffering!==o.isBuffering){var l=e.isBuffering?"...":" completed";a.info("[Embed.ts] > Buffering"+l)}!o.paused&&e.paused&&this.showControls(!0),this.timelineLayout.setProps({timelineState:e}),this.timelineSeekBar.setProps({timelineState:e});var c=isFinite(e.timelinePosition)?Panopto.Core.TimeHelpers.formatDuration(e.timelinePosition,":",!1,0,!1):"";$(".fp-elapsed").text(c),$(".fp-duration").text(Panopto.Core.TimeHelpers.formatDuration(e.duration,":",!1,0,!1)),$(".fp-remaining").text(Panopto.Core.TimeHelpers.formatDuration(e.duration-e.timelinePosition,":",!1,0,!1)),this.displaySpeed(e.playbackRate),e.activeSecondary instanceof PanoptoViewer.DocumentPlayer?$("#embed").toggleClass("show-interactivity",!1):$("#embed").toggleClass("show-interactivity","none"!==this.interactivity),this.isMobile&&e.isBuffering?$(".mobile-transport-controls .play").hide():$(".mobile-transport-controls .play").show(),this.eventOverlay&&this.eventOverlay.setProps({currentTime:e.timelinePosition}),(e.timelinePosition>=e.duration||e.isEnded)&&(this.playlistId?this.playlistOverlay.queueNextItem():this.delivery.nextDelivery&&this.showNextDelivery())},n.prototype.configureTimelineControllerControls=function(){var e=this;new PanoptoViewer.Controls.TimelineHotkeys((function(t){switch(e.showControls(n.controlDisplayDuration),t){case"togglePlayState":e.isLiveBroadcast?e.timelineController.start(1/0):e.player.hasClass("is-ready")?e.togglePlayState():e.loadVideo();break;case"seekToBeginning":e.seekTo(0);break;case"seekToEnd":e.seekTo(10);break;case"rewind":e.seek(!1);break;case"forward":e.seek(!0);break;case"seekTo0Pct":e.seekTo(0);break;case"seekTo10Pct":e.seekTo(1);break;case"seekTo20Pct":e.seekTo(2);break;case"seekTo30Pct":e.seekTo(3);break;case"seekTo40Pct":e.seekTo(4);break;case"seekTo50Pct":e.seekTo(5);break;case"seekTo60Pct":e.seekTo(6);break;case"seekTo70Pct":e.seekTo(7);break;case"seekTo80Pct":e.seekTo(8);break;case"seekTo90Pct":e.seekTo(9);break;case"seekToPrevious":e.seekTo();break;case"volumeUp":e.timelineController.volume(Math.min(e.timelineState.volume+.1,1));break;case"volumeDown":e.timelineController.volume(Math.max(e.timelineState.volume-.1,0));break;case"toggleMuted":e.timelineController.muted(!e.timelineState.muted);break;case"toggleFullscreen":e.toggleFullscreen();break;case"toggleCaption":e.nonNativeCaptionsAvailable&&e.activateCaptionsToggle();break;case"playbackRateDown":e.vspSupported&&e.setSpeed(!1);break;case"playbackRateUp":e.vspSupported&&e.setSpeed(!0);break;case"cancel":e.menuOpen?(e.hideMenus(),e.playlistOverlay&&e.playlistOverlay.hide(),e.showControls(n.controlDisplayDuration)):e.autoHideEnabled?e.showControls(!1,{ignorePlayState:!0}):Panopto.Core.ElementHelpers.blurActiveElement();break;case"sendLogs":e.submitClientLog()}}));$("#overlay").append("<div class='layout-container'></div>"),this.timelineLayout=PanoptoReactComponents.bootstrapReactComponent(PanoptoViewer.Controls.TimelineLayout)($(".layout-container"),{resources:Panopto.GlobalResources,timelineState:this.timelineState,onCycleSecondaryRequested:function(){e.timelineController.cycleSecondary(),e.showControls(n.controlDisplayDuration)},onLayoutRequested:function(t){e.timelineController.playerLayoutMode(t),e.showControls(n.controlDisplayDuration)}}),$("#hoverButtonContainer").prepend("<div class='seek-bar-container'></div>"),this.timelineSeekBar=PanoptoReactComponents.bootstrapReactComponent(PanoptoViewer.Controls.TimelineSeekBar)($(".seek-bar-container"),{timelineState:this.timelineState,onPlayRequested:function(t){t?e.timelineController.pause():e.timelineController.resume()},onSeekRequested:function(t){Panopto.viewer.disableSeekAndVsp||(e.lastTimelinePositionRequested=t,e.timelineController.seek(t))},colors:{trackPlayedColor:"rgba(255, 255, 255, 0.8)",trackPlayedActiveColor:"#FFF",trackBackgroundColor:"transparent",trackBorderColor:"rgba(255, 255, 255, 0.3)",labelFontColor:"#FFF",labelBackgroundColor:"rgba(0, 0, 0, 0.8)"}}),Panopto.viewer.disableSeekAndVsp&&this.preventUserSeek(),$(".flowplayer-time-display").append("<span class='fp-elapsed'></span><span class='fp-duration'></span><span class='fp-remaining'></span>");var t=$(".fp-duration"),o=$(".fp-remaining").hide();t.click((function(){t.hide(),o.show()})),o.click((function(){t.show(),o.hide()})),this.fullscreenEnabled&&!$.browser.iphone&&this.configureFullscreenControls(),$("#embed").toggleClass("mobile",this.isMobile),this.player.toggleClass("mobile",this.isMobile),$(".touch-overlay").toggle(this.isMobile),$("#loadingSpinner").remove(),this.isLiveBroadcast&&$(".bottom-transport-controls, .mobile-transport-controls, .seek-bar-container, .fp-duration").hide(),$("#overlay").css({"z-index":11})},n.prototype.embedControlSetupFlowplayer=function(){var e=this;this.embedApiParser=new PanoptoViewer.EmbedApiParser(this.handleEmbedApiCommand,this.remoteHost,this.embedApiId),this.flowplayer.splash&&this.embedApiParser.sendPostMessage(PanoptoViewer.EmbedApiMessagesToParent.IframeReady),this.flowplayer.on("pause resume stop playing finish seek volume progress speed error",(function(t){switch(t.type){case"pause":case"resume":case"stop":case"playing":case"finish":e.sendApiStateUpdate(PanoptoViewer.EmbedApiMessagesToParent.StateUpdate);break;case"speed":e.sendApiStateUpdate(PanoptoViewer.EmbedApiMessagesToParent.SpeedUpdate);break;case"error":e.embedApiParser.sendPostMessage(PanoptoViewer.EmbedApiMessagesToParent.Error);break;default:e.sendApiStateUpdate(void 0)}}))},n.prototype.sendReactNativeStateUpdate=function(){var e,t=null;this.flowplayer?t={name:this.delivery.title,folderName:this.delivery.folder.name,thumbUrl:(Panopto.uriScheme+"://"+Panopto.webServerFQDN+this.initParams.ThumbUrl).replace("usePng=False","usePng=True"),streamUrl:this.flowplayer.video.src,isPlaying:this.flowplayer.playing,position:this.flowplayer.video.time,playbackRate:this.flowplayer.currentSpeed,isMuted:this.flowplayer.muted}:this.timelineController&&(t={name:this.delivery.title,folderName:this.delivery.folder.name,thumbUrl:(Panopto.uriScheme+"://"+Panopto.webServerFQDN+this.initParams.ThumbUrl).replace("usePng=False","usePng=True"),streamUrl:null===(e=this.timelineState.activePrimary)||void 0===e?void 0:e.streamUrl,isPlaying:!this.timelineState.paused,position:this.timelineState.timelinePosition,playbackRate:this.timelineState.playbackRate,isMuted:this.timelineState.muted}),t&&this.isReactNativeApp&&this.sendReactNativeMessage({action:"state",state:t})},n.prototype.sendApiStateUpdate=function(e){var t;this.embedApiParser&&(this.flowplayer?t={trigger:e,volume:this.flowplayer.volumeLevel,isMuted:0===this.flowplayer.volumeLevel,currentTime:this.flowplayer.video.time,speed:this.flowplayer.currentSpeed,duration:this.flowplayer.video.duration,isPaused:this.flowplayer.paused,isFinished:this.flowplayer.finished,captionLanguages:this.availableLanguagesFriendly,selectedLanguage:this.initParams.AvailableLanguages.indexOf(this.selectedCaption),areCaptionsEnabled:this.captionsDisplayed}:this.timelineController&&(t={trigger:e,volume:this.timelineState.volume,isMuted:this.timelineState.muted,currentTime:this.timelineState.timelinePosition,speed:this.timelineState.playbackRate,duration:this.timelineState.duration,isPaused:this.timelineState.paused,isFinished:this.timelineState.paused&&this.timelineState.timelinePosition===this.timelineState.duration,captionLanguages:this.availableLanguagesFriendly,selectedLanguage:this.initParams.AvailableLanguages.indexOf(this.selectedCaption),areCaptionsEnabled:this.captionsDisplayed}),this.embedApiParser.sendPostMessage(PanoptoViewer.EmbedApiMessagesToParent.State,t))},n.prototype.sendReactNativeMessage=function(e){var t,o="back"===e.action?e.action:JSON.stringify(e);null===(t=window.ReactNativeWebView)||void 0===t||t.postMessage(o),console.log(o)},n.prototype.render=function(){var t=this;$("#title").toggle(this.showTitle),$("#embed").toggleClass("show-interactivity","none"!==this.interactivity),this.player.toggleClass("audio-only",this.initParams.IsAudioOnly);var i=o.getProviderForUser(Panopto.user);i&&Panopto.GoogleAnalytics.sendEvent({source:"viewer-embed",action:"embedded-view",label:i}),this.configureGlobalControls(),this.configureSplashScreen();var a=new e.Viewer.AutoPlayDetector({muted:this.startMuted,playsInline:!0,autoPlayRequested:this.autoPlayRequested}).detect();if(this.initParams.ErrorCode)this.handleError();else if(this.delivery)if(this.isLiveBroadcast&&!this.delivery.activePrimary)this.showCallToAction({message:Panopto.GlobalResources.Embed_BroadcastNotStarted});else if(this.enableMultistream&&this.delivery.activePrimary)PanoptoViewer.FpPrimitivePlayer.setFlowplayerKey(this.initParams.PlayerKey),Panopto.user.userId||(this.delivery.documents=this.delivery.documents.filter((function(e){return!e.isQuiz}))),this.timelineController=new PanoptoViewer.TimelineController(this.delivery,Panopto.appRoot,(function(e){return t.handleTimelineControllerStateChanged(e)}),{resetToStartUponVoDEnd:!(this.remoteEmbed&&Panopto.enableEmbedApi),defaultLayout:this.defaultLayout,focusService:Panopto.Core.UI.Accessibility,notifyInitialState:function(e){t.timelineState=e}}),this.initParams.AvailableLanguages.length>0&&this.getCaptions(this.deliveryId,this.inviteId,this.selectedCaption).done((function(){$("#captionsButton").show(),t.toggleCaptions(t.captionsDisplayed)})),this.configureTimelineControllerControls(),this.configurePanoptoControls(),this.generateCaptionStylesheet(),"none"!==this.interactivity&&this.configureEventsControl(),this.hideOverlay&&$("#hoverButtonContainer").css("visibility","hidden"),Panopto.user.userId&&(this.quizResultsController=new e.Viewer.QuizResultsController(this.quizzes,this.ltiOutcomeConfig),this.quizResultsController.onQuizCompleted(this.timelineController.dismissDocumentPlayer),this.quizResultsController.onQuizClosed(this.timelineController.dismissDocumentPlayer)),a.then((function(e){e&&t.playlistId||(t.initParams.ShowCopyrightNotice?t.copyrightNotice.showNotice(t.checkCopyrightNoticeRequirement.resolve):t.checkCopyrightNoticeRequirement.resolve()),e?t.loadVideo():($("#playIconContainer").toggle(!t.isMobile),$("#splashPlayIconContainer").toggle(t.isMobile))})),this.remoteEmbed&&Panopto.enableEmbedApi&&(this.embedApiParser=new PanoptoViewer.EmbedApiParser(this.handleEmbedApiCommand,this.remoteHost,this.embedApiId),this.embedApiParser.sendPostMessage(PanoptoViewer.EmbedApiMessagesToParent.IframeReady));else{if("none"!==this.interactivity&&this.configureEventsControl(),this.initializePlayer(),this.fullscreenEnabled&&this.configureFullscreenControls(),this.remoteEmbed&&Panopto.enableEmbedApi&&this.embedControlSetupFlowplayer(),this.isReactNativeApp&&this.flowplayer.on("pause resume stop playing finish seek progress speed volume",(function(){t.sendReactNativeStateUpdate()})),this.initializeQuotaTracker(),Panopto.useFreeTrialTerminology&&!this.isLandscape&&!Panopto.user.userId){var n=this.delivery.user.email||"null";Panopto.SignupBanner($("#proLoginBanner"),{imageLocation:Panopto.cacheRoot+"/Styles/Less/Application/Images/Header",signupUrl:Panopto.freeTrialSignUpUrl,isEmbed:!0,tokenId:this.inviteId,userEmail:n,resources:Panopto.GlobalResources})}if("undefined"!=typeof playerjs)Panopto.PlayerJsFlowplayerAdapter(this.flowplayer,{loadCallback:function(){t.loadVideo()}}).ready();this.flowplayer.one("ready",(function(){if(t.videoElement=t.player.find("video.fp-engine")[0],t.hideOverlay?$(".fp-ui").hide():(t.configureFlowplayerControls(),t.configurePanoptoControls(),t.configureKeyHandler()),t.quizzes.length&&(Panopto.user.userId||Panopto.showQuizWarning)&&(t.configureProgressListener(!Panopto.user.userId),Panopto.user.userId&&t.configureQuizResultsController()),t.videoElement&&(t.videoElement.textTracks.length&&(t.isLiveBroadcast&&!t.nonNativeCaptionsAvailable?($("#captionsButton").toggle(!0),t.updateDividerVisibility(),t.captionsDisplayed=t.shouldDisplayCaptionsInitially,t.toggleNativeCaptions(!0)):t.toggleNativeCaptions(!1)),t.videoElement.textTracks.onaddtrack=function(e){t.isLiveBroadcast&&!t.nonNativeCaptionsAvailable?($("#captionsButton").toggle(!0),t.updateDividerVisibility(),t.toggleNativeCaptions(!0)):e.track.mode="disabled"},t.isLiveBroadcast)){var e=!1;t.flowplayer.on("pause",(function(){return e=!0})),t.flowplayer.on("pause",(function(){t.isFlowPlayerAtTheEnd()&&t.checkWebcastEnded(!0)}));var o=!1;t.flowplayer.on("finish",(function(){return o=!0})),document.addEventListener("visibilitychange",(function(){document.hidden||!e||o||(t.flowplayer.load(t.flowplayer.conf.clip),e=!1)}))}if(t.toggleCaptions(t.captionsDisplayed),t.scormEnabled){var i={position:function(e){return t.flowplayer.seek(e)},reportPercentCompleted:t.reportPercentCompleted.bind(t)};t.scormControl=Panopto.Viewer.ScormControl(i,t.delivery.duration),t.updateScormProgress()}else t.startTime&&!t.flowplayer.engine.hls&&t.flowplayer.one("progress",(function(){t.flowplayer.seek(t.startTime)}))})),a.then((function(e){e&&t.playlistId||(t.initParams.ShowCopyrightNotice?t.copyrightNotice.showNotice(t.checkCopyrightNoticeRequirement.resolve):t.checkCopyrightNoticeRequirement.resolve()),e&&!t.playlistId?t.loadVideo():($("#playIconContainer").toggle(!t.isMobile),$("#splashPlayIconContainer").toggle(t.isMobile))})),this.eventOverlay&&this.flowplayer.on("progress",(function(e,o,i){t.eventOverlay.setProps({currentTime:i})})),this.playlistId?this.flowplayer.on("finish",(function(){return t.playlistOverlay.queueNextItem()})):this.delivery.nextDelivery&&this.flowplayer.on("finish",(function(){return t.showNextDelivery()}))}else this.initParams.ErrorCode=Panopto.Core.ErrorCode.InvalidDelivery,this.handleError();this.playlistId&&a.then((function(e){t.configurePlaylistOverlay(e)}))},n.prototype.configureEventsControl=function(){var e=this;Panopto.Core.UI.Handlers.button($("#eventOverlayGutter .hit-target"),(function(t,o){e.toggleEventOverlay(!e.eventOverlayShown,{keyboardInitiated:"mousedown"!==o.type}),e.eventOverlayShown&&e.hideMenus(),e.showControls(!e.eventOverlayShown,{ignorePlayState:!0})}),{pointerEvent:"mousedown touchstart"});var t={delivery:this.delivery,sessionId:this.sessionId,userId:Panopto.user.userId,loginUrl:Panopto.loginUrl,currentTime:0,isLandscape:this.isLandscape,isMobile:this.isMobile,isMobileApp:this.isApp,isBroadcast:this.isLiveBroadcast,interactivity:this.interactivity,areSocialFeaturesEnabled:Panopto.features.areSocialFeaturesEnabled,areRatingsEnabled:Panopto.features.areRatingsEnabled,resources:Panopto.GlobalResources,initialSearchTerm:this.initialSearchTerm,availableLanguages:this.initParams.AvailableLanguages.slice(0,3),selectedLanguage:this.selectedCaption,showAllToCEntries:this.enableMultistream,onLanguageChanged:function(t){e.selectedCaption=t,e.userSettingService.setSetting(e._selectedCaptionSetting,e.selectedCaption),e.loadSubtitleTrack()},onSeekRequested:function(t){Panopto.viewer.disableSeekAndVsp||(e.toggleEventOverlay(!1),e.showControls(n.playDisplayDuration),e.flowplayer?e.flowplayer.splash?(e.startTime=t,e.flowplayer.conf.hlsjs.startPosition=t,e.loadVideo()):e.seek(t,(function(){return e.flowplayer.resume()})):e.timelineController&&(e.player.hasClass("is-ready")?(e.timelineController.seek(t),e.timelineController.resume()):(e.startTime=t,e.loadVideo())))},onKeyDown:function(t){t.which===i.Esc&&e.isLandscape&&e.eventOverlayShown&&(e.toggleEventOverlay(!1),e.showControls(n.controlDisplayDuration),$("#eventOverlay").one("transitionend",(function(){$("#eventOverlayGutter .hit-target").focus()})))},showSendLogs:!!this.invocationId,onSubmitLogs:function(){return e.submitClientLog()}};this.eventOverlay=Panopto.EmbedEventOverlay($("#eventTabControl"),t)},n.prototype.toggleEventOverlay=function(e,t){var o=(void 0===t?{}:t).keyboardInitiated,i=void 0!==o&&o;"none"!==this.interactivity&&(this.eventOverlayShown=void 0!==e?e:!this.eventOverlayShown,$("#embed").toggleClass("event-overlay-shown",this.eventOverlayShown),this.eventOverlayShown?$("#eventOverlayGutter .hit-target").attr("aria-expanded","true"):$("#eventOverlayGutter .hit-target").removeAttr("aria-expanded"),this.timelineController&&(this.eventOverlayShown?this.timelineController.captionVisible(!1):this.timelineController.captionVisible(this.captionsDisplayed)),this.isLandscape&&this.handleEventOverlayModeChanged({isOverlay:this.eventOverlayShown,keyboardInitiated:i}))},n.prototype.handleEventOverlayModeChanged=function(e){var t=e.isOverlay,o=e.keyboardInitiated,i=void 0!==o&&o;t?Panopto.Core.UI.Accessibility.trapFocus(this.eventOverlayElement):Panopto.Core.UI.Accessibility.releaseFocus(this.eventOverlayElement),t&&$("#eventOverlay").one("transitionend",(function(){var e=$("#eventOverlay").find(":tabbable").first();e.focus(),i||(e.addClass("clicked"),e.one("blur",(function(){return e.removeClass("clicked")})))}))},n.prototype.initializePlayer=function(){var e={sources:[{type:this.initParams.MediaFileType===Panopto.Core.MediaFileType.hls?n.hlsMimeType:n.mp4MimeType,src:this.videoUrl}],live:this.isLiveBroadcast,vr:this.isVR};if(this.preferFlash){var t=_.extend({engine:"flash"},e.sources[0]);this.initParams.MediaFileType===Panopto.Core.MediaFileType.mp4&&this.initParams.RtmpServerUrl&&(e.rtmp=this.initParams.RtmpServerUrl,t={type:n.rtmpMimeType,src:this.initParams.RtmpRelativeUrl}),e.sources.unshift(t)}if(this.nonNativeCaptionsAvailable){var o=this.initParams.CaptionUrl.map((function(e){return{kind:"subtitles",label:Panopto.GlobalResources.ModalPopup_SessionTranscriptDisplayName,src:e}}));e.subtitles=o,this.generateCaptionStylesheet()}var i=-1!==window.location.search.indexOf("debuglog=true"),r={startLevel:-1,safari:!0,debug:new PanoptoViewer.HlsjsDebugLogger};this.startTime&&(r.startPosition=this.startTime);var s={};try{s=JSON.parse(Panopto.viewer.hlsJsConfig)}catch(e){a.warning("Error parsing HlsJsConfig setting, ignored.")}_.extend(r,s),this.flowplayer=flowplayer(this.player,{key:this.initParams.PlayerKey,swf:this.initParams.FlowplayerSwfPath,swfHls:this.initParams.FlowplayerHlsSwfPath,clip:e,splash:!0,ratio:!1,fullscreen:!1,native_fullscreen:!0,keyboard:!1,embed:!1,tooltip:!1,speeds:n.playbackSpeeds,hlsjs:r,chromecast:!Panopto.features.disableFeaturesRequiringExternalNetworkAccess,vrvideo:{touchcontrols:!1,polyfill:!0,mode:this.initParams.VRType===PanoptoViewer.MediaVRType.Full?"full":this.initParams.VRType===PanoptoViewer.MediaVRType.Half?"half":void 0,renderOnPause:!0},debug:i}),this.flowplayer.conf.nativesubtitles=!1,this.player.toggleClass("mobile",this.isMobile),$("#player").find(".fp-elapsed, .fp-duration, .fp-remaining").appendTo("#hoverButtonContainer .flowplayer-time-display"),$("#overlay").prependTo(".fp-ui"),$("#hoverButtonContainer").appendTo(".fp-ui"),$("#playbackSpeedMenu").appendTo(".fp-player"),this.player.find(".fp-timeline-tooltip").appendTo(".fp-player"),$("#playlistOverlay").appendTo(".fp-player"),$(".fp-waiting").empty().append($("#loadingSpinner")).insertAfter(".fp-ui")},n.prototype.initializeQuotaTracker=function(){var t=this;if(Panopto.features.quotasEnabled){var o=this.delivery.user.email||"null";this.quotaPlaybackTracker=new e.Controls.QuotaPlaybackTracker(PanoptoCore.CookieHelpers,$("body"),Panopto.GlobalResources,this.deliveryId,this.delivery.ownerId,Panopto.user.userId,this.inviteId?Panopto.Core.StringHelpers.format(Panopto.freeTrialSignUpUrl+Panopto.Core.Constants.SignUpUrlParams,this.inviteId,o):Panopto.freeTrialSignUpUrl),this.quotaPlaybackTracker.onToggle.add((function(e){e?t.flowplayer.pause():t.flowplayer.play()})),this.quotaPlaybackTracker.initialize(this.delivery.ownerIsOverQuota),this.flowplayer.on("finish",(function(){t.quotaPlaybackTracker.fadeInModalForAnonymous()}))}},n.prototype.generateCaptionStylesheet=function(){var e=document.head.appendChild(document.createElement("style")),t=$(window).height(),o=$(window).width(),i=t;(t>o||$.browser.mobile)&&(i=Math.min(t,o)/n.portraitVideoAspectRatio);var a=i/n.defaultHeight,r=n.defaultCaptionScaling*a,s=Panopto.captionSettings.size*r;s=Math.min(Math.max(s,n.minCaptionFontSize),n.maxCaptionFontSize);var l=Panopto.captionSettings.backgroundColor;"transparent"!==l&&(l=Panopto.Core.UI.Color.parse(l).toRGBa(Panopto.captionSettings.opacity)),e.sheet.insertRule("#captionPlayer .caption-player-container > p,#player .fp-subtitle > *,#player .fp-captions > * {color: "+Panopto.captionSettings.color+";background: "+l+";text-shadow: "+Panopto.captionSettings.textShadow+";font-size: "+s+"px;}",0)},n.prototype.configureGlobalControls=function(){var t=this;if(Panopto.Core.UI.Handlers.button($("#appBackButton, #absoluteBackButton"),(function(){t.isIosApp?window.location.href="panopto://close-player":t.isReactNativeApp&&t.sendReactNativeMessage({action:"back"})})),$("#appBackButton").toggle(this.hasBackButton),$("#embed").toggleClass("has-back-button",this.hasBackButton),Panopto.Core.UI.Handlers.button($("#playIconContainer"),(function(){return t.loadVideo()})),Panopto.useFreeTrialTerminology){var o=e.ImageHelpers.getImageUrl("Header/PanoptoLogoWhite.svg");$("#fullViewerButton").html('<img src="'+o+'" onload="SVGInject(this)" />')}Panopto.Core.UI.Handlers.button($("#fullViewerButton"),(function(){if(t.fullViewerLinkEnabled){t.isLiveBroadcast?(t.flowplayer&&t.flowplayer.mute(!0,!0),t.timelineController&&t.timelineController.muted(!0)):(t.flowplayer&&t.flowplayer.pause(),t.timelineController&&t.timelineController.pause());var e=0;t.flowplayer&&(e=t.flowplayer.video.time),t.timelineController&&(e=t.timelineState.timelinePosition||0),window.open(t.initParams.ViewerLink+"&start="+e)}})),$("#fullViewerButton").toggle(!!this.showFullViewerLink),this.fullViewerLinkEnabled||$("#fullViewerButton").addClass("disabled").attr("title",Panopto.GlobalResources.Embed_Tooltip_FullViewerDisabled),Panopto.Core.UI.Handlers.button($("#downloadButton"),(function(){window.open(t.downloadUrl)})),this.downloadEnabled&&$("#downloadButton").removeAttr("style")},n.prototype.configureSplashScreen=function(){var e=this;if(this.enableMultistream&&this.player.toggleClass("is-splash",!0),!this.initParams.IsAudioOnly){var t=this.initParams.ThumbUrl,o=function(e){return $("#splashScreen").css("background-image","url("+e+")")};o(t),$(new Image).on("error",(function(){return o(e.defaultThumbnailUrl)})).prop("src",t)}if(Panopto.Core.UI.Handlers.button($("#splashPlayIconContainer"),(function(){return e.loadVideo()}),{pointerEvent:"mousedown touchend"}),$("#splashScreen").click((function(t){e.menuOpen?(e.playlistOverlay&&e.playlistOverlay.hide(),t.preventDefault(),t.stopPropagation()):e.loadVideo()})),this.showBrand){var i=this.initParams.LogoUrl;i&&-1!==i.indexOf("_branding")&&($("#logo").attr("src",i),Panopto.viewer.viewerWatermarkPosition&&(this.watermark=new PanoptoViewer.WatermarkLogo(i,Panopto.viewer.viewerWatermarkPosition),$("#embed").append(this.watermark.getBrandElem())))}this.isReactNativeApp||($("#cobrand").toggleClass("no-link",!Panopto.features.linkPoweredByPanoptoInEmbed).show(),$("#cobrand a").click((function(e){return e.stopPropagation()})))},n.prototype.configureFullscreenControls=function(){var e=this;Panopto.Core.UI.Handlers.button($("#fullScreenButton"),(function(){e.toggleFullscreen()})),Panopto.Core.Browser.fullscreenEnabled?($("#fullScreenButton").show(),$(document).on("fullscreenchange webkitfullscreenchange mozfullscreenchange MSFullscreenChange",(function(){var t=e.isFullscreen;$("#fullScreenIcon").toggle(!t),$("#fullScreenExitIcon").toggle(t)}))):$.browser.iphone&&(this.flowplayer.on("fullscreen",(function(){return e.handleNativeFullscreenToggled(!0)})),this.flowplayer.on("fullscreen-exit",(function(){return e.handleNativeFullscreenToggled(!1)})))},Object.defineProperty(n.prototype,"isFullscreen",{get:function(){return Boolean(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)},enumerable:!1,configurable:!0}),n.prototype.toggleFullscreen=function(e){if(this.fullscreenEnabled&&e!==this.isFullscreen)if(e=void 0===e?!this.isFullscreen:e,Panopto.Core.Browser.fullscreenEnabled){var t=_.find(["requestFullScreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen"],(function(e){return"function"==typeof document.documentElement[e]})),o=_.find(["exitFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],(function(e){return"function"==typeof document[e]}));e?document.body[t]():document[o]()}else $.browser.iphone&&(this.iPhoneReturnFromFullscreenPlaying=!this.videoElement.paused,this.flowplayer.fullscreen())},n.prototype.handleNativeFullscreenToggled=function(e){var t=this;if(this.nativeFullscreen=e,this.player.find("video").toggleClass("native-fullscreen",e),e)this.captionsDisplayed&&this.videoElement.textTracks.length&&this.toggleNativeCaptions(!0);else{var o=!1;_.each(this.videoElement.textTracks,(function(e){"showing"===e.mode&&(o=!0),e.mode="disabled"})),this.toggleCaptions(o),this.iPhoneReturnFromFullscreenPlaying&&setTimeout((function(){return t.videoElement.play()}),0)}},n.prototype.updateBroadcast=function(e){var t=this;if(this.delivery=e,this.timelineController)this.timelineController.updateDelivery(e);else if(this.flowplayer&&!e.broadcastEnded&&e.activePrimary){var o=this.ensureMobileCompatibleManifest(e.activePrimary.url);if(o!==this.videoUrl){this.videoUrl=o;var i=this.flowplayer.conf.clip;_.each(i.sources,(function(e){e.src=o})),this.flowplayer.load(i,(function(){t.loggerSeekHandler&&t.loggerSeekHandler()}))}}},n.prototype.checkForBlockingLTIQuiz=function(){var e=this,t=$("#ltiQuizBlock");Panopto.LTIQuizBlock(t,{deliveryId:this.delivery.id,sessionHasQuiz:this.quizzes.length>0,ltiBlockSetting:PanoptoViewer.LTIQuizBlockingMode[Panopto.viewer.blockLTISessionsWithQuiz],ltiQueryParam:this.isLTIContext,checkBlockSessionOnQuizReporting:Panopto.Core.ServiceInterface.Rest.Sessions.blockSessionOnQuizReporting,onPopupResolved:function(){t.hide(),e.checkBlockingLTIQuiz.resolve()},resources:Panopto.GlobalResources})},n.prototype.loadVideo=function(){var e=this;this.enableMultistream&&this.player.toggleClass("is-splash",!1),this.checkCopyrightNoticeRequirement.done((function(){e.invocationRequested||(e.invocationRequested=!0,e.createInvocation((function(t){var o;t&&(e.invocationId=t,e.deliveryRefreshTimer.setInvocationId(e.invocationId),e.flowplayer&&e.delivery.activePrimary?e.attachPlaybackLogger():e.timelineController&&(e.timelineController.updateInvocationContext(Panopto.user.userId,t),e.delivery.activePrimary&&e.attachPlaybackLoggerToTimelineController()),null===(o=e.eventOverlay)||void 0===o||o.setProps({showSendLogs:!0}))})),e.checkBlockingLTIQuiz.then((function(){if(e.timelineController){if(e.timelineController.start(e.isLiveBroadcast?1/0:e.startTime),e.remoteEmbed&&Panopto.enableEmbedApi&&e.sendApiStateUpdate(PanoptoViewer.EmbedApiMessagesToParent.StateUpdate),e.scormEnabled){var t={position:function(t){return e.timelineController.seek(t)},reportPercentCompleted:e.reportPercentCompleted.bind(e)};e.scormControl=Panopto.Viewer.ScormControl(t,e.delivery.duration),e.updateScormProgress()}e.player.addClass("is-ready"),$().add("#player").add("#eventOverlayGutter").on("mousemove",(function(){e.showControls(n.controlDisplayDuration)})).on("focusin",(function(){e.showControls(n.controlDisplayDuration)})).on("mouseleave",(function(){if(e.autoHideEnabled){var t=!e.autoHideRequested;e.showControls(!1,{slowFade:!0,ignorePlayState:t})}})),$("#overlay").addClass("fp-ui"),$("#hoverButtonContainer").addClass("fp-ui"),e.hideOverlay&&($(".touch-overlay").css("visibility","hidden"),$("#overlay").css("visibility","hidden"))}e.flowplayer&&e.flowplayer.load(),$("#splashScreen").hide(),$("#gradientTop, #gradientBottom").insertAfter($("#splashScreen")),$.browser.iphone&&!e.enableMultistream&&$("#fullScreenButton").toggle(e.fullscreenEnabled),$("#playIconContainer").off("click keydown").attr("tabindex",null).fadeOut(500),e.showControls(n.playDisplayDuration)})))}))},n.prototype.createInvocation=function(e){var t=this,o=Panopto.Core.InvocationType.None;o=this.isIosApp?this.isLiveBroadcast?Panopto.Core.InvocationType.MobileApplicationBroadcast:Panopto.Core.InvocationType.MobileApplication:this.isAndroidApp?this.isLiveBroadcast?Panopto.Core.InvocationType.AndroidApplicationBroadcast:Panopto.Core.InvocationType.AndroidApplication:this.isReactNativeApp?this.isLiveBroadcast?Panopto.Core.InvocationType.ReactNativeMobileBroadcast:Panopto.Core.InvocationType.ReactNativeMobile:this.isVideoPreview?this.isLiveBroadcast?Panopto.Core.InvocationType.VideoPreviewBroadcast:Panopto.Core.InvocationType.VideoPreview:this.isLiveBroadcast?Panopto.Core.InvocationType.EmbedBroadcast:Panopto.Core.InvocationType.EmbedViewer;var i={deliveryId:this.deliveryId,inviteId:this.inviteId,invocationType:o};Panopto.viewer.ultraHighScaleAnonymousWebcastMode?e():PanoptoCore.TokenAuth.getStoredAuthToken().then((function(o){if(o){var a={url:Panopto.appRoot+"/Services/Data.svc/CreateInvocation",method:"POST",data:JSON.stringify(i),dataType:"json",accessToken:o,contentType:"application/json; charset=UTF-8",loadingIndicator:"",sendCredentials:!1};PanoptoCore.Helpers.ApiHelpers.CallAPI(a).then((function(t){var o=t.data&&void 0!==typeof t.data.d?t.data.d:t.data;e(o)})).fail((function(o){403===o?location.replace(t.loginUrl):e()}))}else Panopto.Util.callWebMethod({methodName:"CreateInvocation",serviceURL:Panopto.appRoot+"/Services/Data.svc",params:i,onSuccess:function(t){return e(t)},onFailure:function(o){403===o._statusCode?location.replace(t.loginUrl):e()},loadingIndicator:""})}))},n.prototype.attachPlaybackLoggerToTimelineController=function(){var e=this;Panopto.Core.Analytics.PlaybackLogger(this.timelineController.createPlayerInterfaceForPlaybackLogger(),this.invocationId,Panopto.Core.ServiceInterface.AnalyticsIngest.addStreamRequests,{onSpanUpdated:function(t){e.quotaPlaybackTracker&&e.quotaPlaybackTracker.update(t)}}).start()},n.prototype.isFlowPlayerAtTheEnd=function(){return this.isPositionAtTheEnd(this.flowplayer.video.time,this.flowplayer.video.duration)},n.prototype.isPositionAtTheEnd=function(t,o){return t>=o-e.Viewer.Constants.EndPositionThreshold},n.prototype.attachPlaybackLogger=function(){var t=this,o={position:function(){var o=e.Viewer.Constants.NativePositionFallbackRegion,i=t.flowplayer.video.time||0;return i>o&&t.videoElement&&t.videoElement.currentTime<o&&(i=t.videoElement.currentTime),i},playSpeed:function(){return t.flowplayer.currentSpeed},streamId:function(){return t.delivery.activePrimary.id},onSeek:function(e){t.loggerSeekHandler=e},offSeek:function(){t.loggerSeekHandler=void 0},onSpeedChange:function(e){t.loggerSpeedChangeHandler=e},offSpeedChange:function(){t.loggerSpeedChangeHandler=void 0},onPlayStateChangeLog:function(e){t.loggerPlayStateChangeHandler=e},offPlayStateChangeLog:function(){t.loggerPlayStateChangeHandler=void 0}},i=Panopto.viewer.ultraHighScaleAnonymousWebcastMode?$.noop:Panopto.Core.ServiceInterface.AnalyticsIngest.addStreamRequests,a=Panopto.Core.Analytics.PlaybackLogger(o,this.invocationId,i,{onSpanUpdated:function(e){t.quotaPlaybackTracker&&t.quotaPlaybackTracker.update(e)}}),n=function(){a.start(),t.isLiveBroadcast&&t.flowplayer.one("progress",(function(){t.loggerSeekHandler&&t.loggerSeekHandler()}))};this.flowplayer.on("seek",(function(){t.loggerSeekHandler&&t.loggerSeekHandler()})),this.flowplayer.on("pause",(function(){var e=t.isFlowPlayerAtTheEnd()?Panopto.Core.ViewerPlayState.Stopped:Panopto.Core.ViewerPlayState.Paused;t.loggerPlayStateChangeHandler&&t.loggerPlayStateChangeHandler(Panopto.Core.ViewerPlayState.Playing,e)})),this.flowplayer.on("resume",(function(){t.flowplayer.video.time<t.flowplayer.video.duration&&t.loggerPlayStateChangeHandler&&t.loggerPlayStateChangeHandler(Panopto.Core.ViewerPlayState.Paused,Panopto.Core.ViewerPlayState.Playing)})),this.flowplayer.on("stop",(function(){t.loggerPlayStateChangeHandler&&t.loggerPlayStateChangeHandler(void 0,Panopto.Core.ViewerPlayState.Stopped)})),this.flowplayer.ready?n():this.flowplayer.one("ready",(function(){return n()}))},n.prototype.configureFlowplayerControls=function(){var e,t,o=this,i=this.player.find(".fp-timeline"),a=this.player.find(".fp-timeline-tooltip");this.player.add($("#embed #eventOverlayGutter")).on("mousemove",(function(i){void 0===e||i.pageX===e&&i.pageY===t||o.eventOverlayShown&&o.isLandscape||o.showControls(n.controlDisplayDuration),e=i.pageX,t=i.pageY})).on("focusin",(function(){return o.showControls(n.controlDisplayDuration)})).on("mouseleave",(function(){if(o.autoHideEnabled){var e=!o.autoHideRequested;o.showControls(!1,{slowFade:!0,ignorePlayState:e})}})),this.flowplayer.on("resume",(function(){return o.showControls(n.playDisplayDuration)})),this.player.find(".fp-player").on("touchmove touchend",(function(){return o.showControls(n.controlDisplayDuration)})),this.isMobile||i.hover((function(){o.menuOpen||a.show()}),(function(){a.hide()})),i.attr({tabindex:1,role:"slider","aria-valuemin":0,"aria-valuemax":Math.round(this.flowplayer.video.duration),"aria-valuenow":Math.round(this.flowplayer.video.time),"aria-label":Panopto.GlobalResources.Embed_Timeline}),this.flowplayer.on("progress",(function(){i.attr("aria-valuenow",Math.round(o.flowplayer.video.time))})),Panopto.viewer.disableSeekAndVsp&&this.preventUserSeek(),this.isVR&&this.configureVRControls()},n.prototype.configureVRControls=function(){var e,t,o=this;this.player.find(".fp-ui").mousedown((function(o){e=o.pageX,t=o.pageY})).click((function(i){!(i.which===Panopto.Core.MouseButton.Left&&e===i.pageX&&t===i.pageY)||o.isLiveBroadcast||o.isMobile||o.togglePlayState()})),this.player.find(".fp-timeline").click((function(e){return e.stopPropagation()}))},n.prototype.updateDividerVisibility=function(){(this.downloadEnabled||this.showFullViewerLink)&&(this.nonNativeCaptionsAvailable||this.vspSupported||this.fullscreenEnabled)&&$("#divider").show()},n.prototype.configurePanoptoControls=function(){var e=this;this.player.find(".touch-overlay").on("touchend click",(function(t){e.showControls(n.controlDisplayDuration),"touchend"===t.type?(t.preventDefault(),t.stopPropagation()):e.menuOpen||e.isLiveBroadcast||e.isMobile||e.togglePlayState()})),$("#overlay, #title, #gradientTop, #gradientBottom").on("click touchend",(function(t){var o=t.target!==t.currentTarget;o||e.menuOpen||e.isLiveBroadcast||e.isMobile||e.togglePlayState(),!o&&e.isMobile&&e.showControls(!1,{ignorePlayState:!0}),e.flowplayer&&t.stopPropagation()})).dblclick((function(t){t.target!==t.currentTarget||e.isMobile||e.toggleFullscreen()}));var t=this.player.find(".mobile-transport-controls .play, .bottom-transport-controls .play");Panopto.Core.UI.Handlers.button(t,(function(){return e.togglePlayState()}),{pointerEvent:"mousedown touchstart"});var o=function(){var o=Panopto.GlobalResources[e.player.is(".is-playing")?"Embed_Tooltip_Pause":"Embed_Tooltip_Play"];t.attr({title:o,"aria-label":o})};this.flowplayer&&this.flowplayer.on("pause resume stop",(function(){return o()})),this.flowplayer&&o(),Panopto.Core.UI.Handlers.button($("#player .mobile-transport-controls .skip-back").add($("#player .bottom-transport-controls .skip-back")),(function(t,o){var i=e.timelineController?e.timelineState.timelinePosition:e.flowplayer.video.time;e.seek(Math.max(i-10,0)),o.stopPropagation()}),{pointerEvent:"mousedown touchstart"}),Panopto.Core.UI.Handlers.button($("#player .mobile-transport-controls .skip-forward").add($("#player .bottom-transport-controls .skip-forward")),(function(t,o){var i=e.timelineController?e.timelineState.timelinePosition:e.flowplayer.video.time,a=e.timelineController?e.timelineState.duration:e.flowplayer.video.duration;e.seek(Math.min(i+10,a)),o.stopPropagation()}),{pointerEvent:"mousedown touchstart"}),this.configureVolumeControls(),Panopto.Core.UI.Handlers.button($("#captionsButton"),(function(){e.activateCaptionsToggle()})),$("#captionsButton").toggle(this.nonNativeCaptionsAvailable),this.updateDividerVisibility(),_.each(n.menus,(function(t){Panopto.Core.UI.Handlers.button($(t.buttonSelector),(function(o,i){e.toggleMenu(t);var a=$(t.menuSelector).find("."+n.selectedClass);$(o).is(".on")&&a.length&&(e.focusMenuItem(a),a.toggleClass(n.clickedClass,"click"===i.type))}))})),this.player.click((function(t){_.each(n.menus,(function(o){$(t.target).closest(o.menuSelector).length||e.toggleMenu(o,!1)})),e.playlistOverlay&&!$(t.target).closest("#playlistOverlay").length&&e.playlistOverlay.hide(),$(t.target).closest(".layout-container").length||(t.preventDefault(),t.stopPropagation())})),this.vspSupported&&this.configurePlaybackSpeedControls()},n.prototype.configureVolumeControls=function(){var e=this;this.configureMuteButton(),this.isMobile?n.flowplayerGlobal.support.volume&&this.toggleMuted(this.startMuted):this.configureVolumeSlider(),this.flowplayer&&this.flowplayer.on("volume",(function(){var t=100*e.flowplayer.volumeLevel;e.setVolumeCookie(t)}))},n.prototype.setVolumeCookie=function(e){this.startTourMutedQuery||PanoptoCore.CookieHelpers.setUserCookieField(Panopto.user.userKey,n.volumeCookieKey,e)},n.prototype.configureMuteButton=function(){var e=this;Panopto.Core.UI.Handlers.button($("#muteButton"),(function(){return e.toggleMuted()})),$("#muteButton").show();var t=function(){var t=Panopto.GlobalResources[e.flowplayer.muted?"Embed_Muted":"Embed_Unmuted"];$("#muteButton").attr("title",t)};this.flowplayer&&this.flowplayer.on("mute",(function(){return t()})),this.flowplayer&&t()},n.prototype.toggleMuted=function(e){this.flowplayer&&(e=void 0===e?!this.flowplayer.muted:!!e,this.isMobile&&!e?this.flowplayer.volume(n.maxVolume/100):this.flowplayer.mute(e)),this.timelineController&&(e=void 0===e?!this.timelineState.muted:!!e,this.timelineController.muted(e))},n.prototype.configureVolumeSlider=function(){var e=this;Panopto.Core.UI.Handlers.hoverOrDrag($("#volumeControls"),(function(t){e.player.toggleClass("volume-active",t)}));var t=$("#volumeSlider");t.slider({min:0,max:100,step:1,orientation:"horizontal",slide:function(e,t){return o(t.value,{updateSlider:!1})}}),t.find("a.ui-slider-handle").attr("tabindex",n.controlButtonTabindex),this.flowplayer&&this.flowplayer.on("volume",(function(){var t=100*e.flowplayer.volumeLevel;o(t,{updatePlayer:!1})}));var o=function(o,i){var a=void 0===i?{}:i,n=a.updateSlider,r=void 0===n||n,s=a.updatePlayer,l=void 0===s||s;r&&t.slider("value",o),l&&(e.flowplayer&&e.flowplayer.volume(o/100),e.timelineController&&e.timelineController.volume(o/100),0===o&&(e.flowplayer&&e.flowplayer.mute(!0),e.timelineController&&e.timelineController.muted(!0))),$("#volumeLevel").css("width",o+"%")},i=this.startMuted?0:this.initialVolume;o(i),Panopto.Core.UI.Accessibility.slider(t,(function(e){return Panopto.GlobalResources.ViewerPlus_ARIA_PercentValue.format(e)}),Panopto.GlobalResources.Embed_Volume)},n.prototype.configurePlaybackSpeedControls=function(){var e=this,t=_.template($("#playbackSpeedTemplate").html());_.each(n.playbackSpeeds,(function(o){var i=$(t({speed:o,displaySpeed:e.getDisplaySpeed(o)}));i.insertAfter($("#playbackSpeedTemplate")),1===o&&i.toggleClass(n.selectedClass),Panopto.Core.UI.Handlers.button(i,(function(t,o){e.setSpeed($(t).data("speed")),e.toggleMenu(n.menus.playbackSpeed,!1),$("#playbackSpeedButton").focus().toggleClass(n.clickedClass,"click"===o.type)}))})),Panopto.Core.UI.Handlers.key($("#playbackSpeedMenu, #playbackSpeedButton"),(function(t,o){e.showControls(n.controlDisplayDuration);var a=_.contains([i.RightArrow,i.UpArrow],o.which);if($(t).is("#playbackSpeedMenu")){var r=$(document.activeElement)[a?"prev":"next"](".item");r.length&&e.focusMenuItem(r)}else e.setSpeed(a)}),[i.UpArrow,i.DownArrow,i.LeftArrow,i.RightArrow],{preserveExisting:!0}),$("#playbackSpeedButton").show(),this.flowplayer&&this.flowplayer.on("speed",(function(){return e.displaySpeed(e.flowplayer.currentSpeed)})),this.initialPlaySpeed!==PanoptoViewer.PlaySpeed.Normal&&this.setSpeed(this.initialPlaySpeed)},n.prototype.configureKeyHandler=function(){var e=this;$(document).on("keydown",(function(t){if(!($(t.target).closest("#eventOverlay").length||(e.showControls(n.controlDisplayDuration),t.ctrlKey||t.metaKey||t.altKey))){var o=!1,a=t.which;switch(a){case i.Space:e.isLiveBroadcast||e.togglePlayState();break;case i.Home:case i.End:e.seekTo(a===i.Home?0:10);break;case i.UpArrow:case i.DownArrow:case i.LeftArrow:case i.RightArrow:var r=_.contains([i.RightArrow,i.LeftArrow],a),s=_.contains([i.RightArrow,i.UpArrow],a);if(t.shiftKey&&r&&e.vspSupported)e.setSpeed(s);else if(!t.shiftKey){var l=$(t.target).hasClass("fp-timeline");if(r||l)e.seek(s);else if(!r){var c=s?.1:-.1;e.flowplayer.volume(e.flowplayer.volumeLevel+c)}}break;case i.Zero:case i.One:case i.Two:case i.Three:case i.Four:case i.Five:case i.Six:case i.Seven:case i.Eight:case i.Nine:e.seekTo(a-i.Zero);break;case i.Period:e.seekTo();break;case i.M:e.flowplayer.mute();break;case i.F:e.toggleFullscreen();break;case i.C:e.nonNativeCaptionsAvailable&&e.activateCaptionsToggle();break;case i.Esc:e.menuOpen?(e.hideMenus(),e.playlistOverlay&&e.playlistOverlay.hide(),e.showControls(n.controlDisplayDuration)):e.autoHideEnabled?e.showControls(!1,{ignorePlayState:!0}):Panopto.Core.ElementHelpers.blurActiveElement();break;default:o=!0}o||t.preventDefault()}}))},n.prototype.configureOrientationListener=function(){var e=this,t="orientation"in window.screen&&"type"in window.screen.orientation&&"onchange"in window.screen.orientation,o=function(){e.isLandscape=$.browser.mobile?t?0===window.screen.orientation.type.indexOf("landscape"):90===Math.abs(Number(window.orientation)):window.innerWidth>window.innerHeight,e.setLayoutOrientation(e.isLandscape),Panopto.useFreeTrialTerminology&&$("#proLoginBanner").toggle(!e.isLandscape&&!Panopto.user.userId),e.eventOverlay&&e.eventOverlay.setProps({isLandscape:e.isLandscape}),$.browser.android&&$.browser.chrome&&e.toggleFullscreen(e.isLandscape)};$.browser.mobile?t?window.screen.orientation.addEventListener("change",o):window.addEventListener("orientationchange",o):window.addEventListener("resize",o),o()},n.prototype.setLayoutOrientation=function(e){$("#eventOverlay").addClass("no-animation"),$("#embed").toggleClass("landscape",e),this.player[0].offsetHeight,$("#eventOverlay").removeClass("no-animation"),this.eventOverlayShown&&this.handleEventOverlayModeChanged({isOverlay:e})},n.prototype.configureProgressListener=function(t){var o=this,i=0;this.flowplayer.on("progress",(function(a,n,r){if(r!==i){var s=e.Viewer.Logic.ContentLogic.getBlockingContent(o.quizzes,r);if(n.seeking||s||(s=e.Viewer.Logic.ContentLogic.getPausingContent(o.quizzes,i,r)),s&&!t)o.showQuiz(s);else if(s&&t&&!o.quizWarnHasShown){o.quizWarnHasShown=!0,o.flowplayer.pause();var l=o.delivery.user.email||null,c=$("#proViewerSignupPopup");Panopto.SignupPromptPopup(c,{onClose:function(){c.hide(),o.flowplayer.play()},position:r,signupUrl:Panopto.freeTrialSignUpUrl,email:l,token:o.inviteId,sendGoogleAnalytics:function(e,t){return Panopto.GoogleAnalytics.sendProEvent(e,t)},resources:Panopto.GlobalResources})}i=r}}))},n.prototype.showQuiz=function(e){var o=this;if(!this.quizPlayer){this.toggleEventOverlay(!1),this.nativeFullscreen&&(this.videoElement.webkitExitFullScreen(),this.nativeFullscreen=!1),this.player.toggleClass(n.quizLoadingClass,!0);var i=e.timeline[0];this.flowplayer.video.time!==i&&this.flowplayer.seek(i);var a=$.Deferred();this.flowplayer.seeking?this.flowplayer.one("seek",(function(){o.flowplayer.pause(a.resolve)})):this.flowplayer.pause(a.resolve),a.then((function(){o.quizPlayer=new t.QuizPlayer(e,{container:$("#quizContainer"),userId:Panopto.user.userId,invocationId:o.invocationId}),o.quizPlayer.toggle(!1),o.quizPlayer.loadedCallback.add((function(){o.player.toggleClass(n.quizLoadingClass,!1),o.quizPlayer.toggle(!0)})),o.quizPlayer.render()}))}},n.prototype.getSeekPositionAfterQuiz=function(e){var t=e.timeline[0];return"flash"===this.flowplayer.engine.engineName?t=Math.ceil(t/n.flowplayerFlashSeekableIncrement)*n.flowplayerFlashSeekableIncrement+n.flowplayerFlashSeekableOffset:t+=n.quizSeekOffset,t},n.prototype.configureQuizResultsController=function(){var t=this;this.quizResultsController=new e.Viewer.QuizResultsController(this.quizzes,this.ltiOutcomeConfig),this.quizResultsController.onQuizCompleted((function(e){t.quizPlayer.remove(),t.quizPlayer=null,t.flowplayer.seek(t.getSeekPositionAfterQuiz(e),(function(){setTimeout((function(){return t.flowplayer.resume()}),0)}))})),this.quizResultsController.onQuizClosed((function(e){if(t.quizPlayer.remove(),t.quizPlayer=null,e.isSessionPlaybackBlocking){var o=e.timeline[0]-n.quizSeekOffset;o<0&&(o=0),t.flowplayer.seek(o)}else t.flowplayer.seek(t.getSeekPositionAfterQuiz(e),(function(){return t.flowplayer.resume()}))}))},n.prototype.togglePlayState=function(e){if(this.flowplayer)void 0===e&&(e=!this.flowplayer.playing),e!==this.flowplayer.playing&&(this.updatePlayControls(e),e?this.flowplayer.resume():this.flowplayer.pause());else if(this.timelineController){var t=this.timelineController.togglePlayState();this.updatePlayControls(t)}},n.prototype.updatePlayControls=function(e){this.player.toggleClass("is-playing",e),this.player.toggleClass("is-paused",!e),$("#playIcon").toggle(e),$("#pauseIcon").toggle(!e),$("#playIconContainer").finish().show().fadeOut(n.playIconPulseDuration)},n.prototype.isPlaying=function(){var e=!1;return this.timelineState?e=!this.timelineState.paused:this.flowplayer&&(e=this.flowplayer.playing),e},n.prototype.getPosition=function(){var e=0;return this.timelineState?e=this.timelineState.timelinePosition:this.flowplayer&&(e=this.flowplayer.video.time),e},n.prototype.getDuration=function(){return this.timelineState?this.timelineState.duration:this.flowplayer.video.duration},n.prototype.seek=function(e,t){Panopto.viewer.disableSeekAndVsp?t&&t():this.timelineController?("boolean"==typeof e&&(e=this.timelineState.timelinePosition+this.timelineState.duration/10*(e?1:-1)),this.lastTimelinePositionRequested=e,this.timelineController.seek(e,t)):this.flowplayer.seek(e,t)},n.prototype.getSeekToTimelinePositionValue=function(e){return this.timelineState.duration/10*e},n.prototype.seekTo=function(e){if(!Panopto.viewer.disableSeekAndVsp)if(this.timelineController){var t=0;t=void 0!==e?this.getSeekToTimelinePositionValue(e):this.lastTimelinePositionRequested,this.lastTimelinePositionRequested=t,this.timelineController.seek(t)}else this.flowplayer.seekTo(e)},n.prototype.setVolume=function(e){this.timelineController?this.timelineController.volume(e):this.flowplayer&&this.flowplayer.volume(e)},n.prototype.resume=function(){this.timelineController?this.timelineController.resume():this.flowplayer&&this.flowplayer.resume()},n.prototype.pause=function(){this.timelineController?this.timelineController.pause():this.flowplayer&&this.flowplayer.pause()},n.prototype.mute=function(e){this.timelineController?this.timelineController.muted(e):this.flowplayer&&this.flowplayer.mute(e)},n.prototype.stop=function(){this.flowplayer&&this.flowplayer.stop(),this.timelineController&&(this.timelineController.pause(),this.timelineController.seek(0))},n.prototype.showControls=function(e,t){var o=this,i=void 0===t?{}:t,a=i.slowFade,n=void 0!==a&&a,r=i.ignorePlayState,s=void 0!==r&&r,l=!!e||_.isUndefined(e);if(!(this.menuOpen||this.flowplayer&&!this.flowplayer.playing&&!l&&!s||this.timelineController&&this.timelineState.paused&&!l&&!s)){var c=function(){o.hideOverlay||(o.player.toggleClass("is-mouseover",l),o.player.toggleClass("is-mouseout",!l)),o.flowplayer&&!o.flowplayer.splash&&$("#embed").toggleClass("overlay-controls",l),o.timelineController&&(o.timelineState.activePrimary&&$("#embed").toggleClass("overlay-controls",l),o.player.find("#overlay").css("z-index",l?11:1)),l||$(document.activeElement).blur()};!l&&n?(this.player.add($("#embed")).addClass("slow-fade"),c(),this.player[0].offsetHeight,this.player.add($("#embed")).removeClass("slow-fade")):c(),clearTimeout(this.controlsHideTimeoutId),this.autoHideEnabled&&"number"==typeof e&&(this.controlsHideTimeoutId=window.setTimeout((function(){return o.showControls(!1,{slowFade:!0})}),e))}},n.prototype.toggleMenu=function(e,t){t=void 0===t?!$(e.menuSelector).is(".shown"):!!t,$(e.menuSelector).toggleClass("shown",t),$(e.buttonSelector).toggleClass("on",t),this.menuOpen=t},n.prototype.hideMenus=function(){var e=this;_.each(n.menus,(function(t){return e.toggleMenu(t,!1)}))},n.prototype.focusMenuItem=function(e){e.parent().find(".item").attr("tabindex",-1),e.attr("tabindex",n.controlButtonTabindex),e.focus()},n.prototype.activateCaptionsToggle=function(){this.toggleCaptions(),PanoptoCore.CookieHelpers.setUserCookieField(Panopto.user.userKey,n.captionsCookieKey,this.captionsDisplayed),this.initParams.IsAudioOnly&&this.autoHideEnabled&&this.showControls(n.playDisplayDuration)},n.prototype.loadSubtitleTrack=function(){"none"!==this.interactivity&&this.eventOverlay.setProps({selectedLanguage:this.selectedCaption});try{this.timelineController?this.getCaptions(this.deliveryId,this.inviteId,this.selectedCaption):this.flowplayer.loadSubtitles(Math.max(this.initParams.AvailableLanguages.indexOf(this.selectedCaption),0))}catch(e){}},n.prototype.toggleNativeCaptions=function(e){_.each(this.videoElement.textTracks,(function(e){e.mode="disabled"})),this.videoElement.textTracks.length>0&&(this.videoElement.textTracks[0].mode=e?"showing":"disabled")},n.prototype.toggleCaptions=function(t){this.captionsDisplayed=void 0===t?!this.captionsDisplayed:t,$("#captionsButton").toggleClass("on",this.captionsDisplayed).toggleClass("off",!this.captionsDisplayed).prop("title",this.captionsDisplayed?Panopto.GlobalResources.Embed_Tooltip_HideCaptions:Panopto.GlobalResources.Embed_Tooltip_ShowCaptions);var o=this.captionsDisplayed?e.ImageHelpers.getImageUrl("Viewer/closed-caption.svg"):e.ImageHelpers.getImageUrl("Viewer/closed-caption-outline.svg");this.timelineController?this.timelineController.captionVisible(this.captionsDisplayed):this.captionsDisplayed?(this.loadSubtitleTrack(),this.isLiveBroadcast&&!this.nonNativeCaptionsAvailable&&this.videoElement.textTracks.length&&this.toggleNativeCaptions(!0)):(this.flowplayer.disableSubtitles(),this.isLiveBroadcast&&!this.nonNativeCaptionsAvailable&&this.toggleNativeCaptions(!1)),$("#captionSvg").replaceWith('<img class="material-icons" id="captionSvg" src="'+o+'" onload="SVGInject(this)" />')},n.prototype.setSpeed=function(e){var t,o,i=this;if("boolean"==typeof e){var a=_.indexOf(n.playbackSpeeds,(null===(t=this.flowplayer)||void 0===t?void 0:t.currentSpeed)||(null===(o=this.timelineState)||void 0===o?void 0:o.playbackRate)||1),r=a+(e?1:-1),s=r>=0&&r<n.playbackSpeeds.length;e=n.playbackSpeeds[s?r:a]}if(this.preferFlash&&"flash"===this.flowplayer.engine.engineName&&1!==e||this.vspSourceOverrideActive&&1===e){this.vspSourceOverrideActive=!this.vspSourceOverrideActive,this.flowplayer.conf.clip.sources.reverse();var l=this.flowplayer.video.time;this.flowplayer.load(this.flowplayer.conf.clip,(function(){i.flowplayer.seek(l),i.flowplayer.speed(e),i.vspSourceOverrideActive||(i.displaySpeed(1),i.flowplayer.currentSpeed=1)}))}else this.flowplayer?(this.flowplayer.speed(e),this.flowplayer.one("speed",(function(){i.loggerSpeedChangeHandler&&i.loggerSpeedChangeHandler()}))):this.timelineController&&this.timelineController.playbackRate(e)},n.prototype.displaySpeed=function(e){$("#playbackSpeedButton .selected-value").text(this.getDisplaySpeed(e)),$("#playbackSpeedMenu ."+n.selectedClass).removeClass(n.selectedClass),$("#playbackSpeedMenu [data-speed='"+e+"']").addClass(n.selectedClass)},n.prototype.getDisplaySpeed=function(e){var t=Number(e).toLocaleString(Panopto.lang);return Panopto.GlobalResources.Embed_PlaybackSpeedFormat.format(t)},n.prototype.showNextDelivery=function(){var e=this,t=$("#nextDelivery"),i={url:o.setQueryParameters(location.href,{id:this.delivery.nextDelivery.id,autoplay:!0}),title:this.delivery.nextDelivery.title,description:this.delivery.nextDelivery.description,duration:this.delivery.nextDelivery.duration,thumbUrl:this.delivery.nextDelivery.thumbUrl,folderName:this.delivery.folder.name};if(i.url){t.show(),$("#player, #pipPlayer, #gridPlayers, #captionPlayer, #eventOverlay").hide(),Panopto.Core.UI.Components.nextDelivery(t,i,Panopto.GlobalResources.NextDelivery_NextVideo,Panopto.GlobalResources.NextDelivery_PlayAgain,(function(){var o,i;$("#player, #pipPlayer, #gridPlayers, #captionPlayer, #eventOverlay").show(),t.hide(),null===(o=e.flowplayer)||void 0===o||o.play(),null===(i=e.timelineController)||void 0===i||i.resume()}));var a=($(window).height()-t.height())/2;t.css({"padding-top":a+"px","padding-bottom":a+"px"})}},n.prototype.handleError=function(){var e=this;switch(this.initParams.ErrorCode){case Panopto.Core.ErrorCode.SiteDisabled:this.showErrorMessage(Panopto.GlobalResources.Embed_SiteDisabled);break;case Panopto.Core.ErrorCode.LoginRequired:this.showCallToAction({link:{id:"loginLink",url:this.loginUrl,text:Panopto.GlobalResources.Embed_LoginMessage}});break;case Panopto.Core.ErrorCode.AccessRequired:this.showCallToAction({message:Panopto.GlobalResources.Embed_RequestAccess,link:{id:n.requestAccessLinkId,url:"#",text:Panopto.GlobalResources.Embed_RequestAccessLink}}),Panopto.Core.UI.Handlers.button($("#"+n.requestAccessLinkId),(function(){return e.requestAccess()}));break;case Panopto.Core.ErrorCode.NotInAvailabilityWindow:this.showCallToAction({message:Panopto.GlobalResources.Embed_NotInAvailabilityWindow,link:{id:"availabilityLink",url:this.sessionListUrl,target:"_blank",text:Panopto.GlobalResources.ViewerPlus_WatchSomethingElse}});break;case Panopto.Core.ErrorCode.NetworkAccessDenied:this.showCallToAction({message:Panopto.viewer.networkAccessDeniedMessage});break;case Panopto.Core.ErrorCode.PodcastRequired:this.showCallToAction({message:Panopto.GlobalResources.Embed_VideoNotReady}),$("#callToActionContainer .spinner").show();break;case Panopto.Core.ErrorCode.InvalidUrl:this.showErrorMessage(Panopto.GlobalResources.Embed_InvalidUrl);break;case Panopto.Core.ErrorCode.InvalidDelivery:this.showErrorMessage(Panopto.GlobalResources.Embed_InvalidDelivery);break;case Panopto.Core.ErrorCode.InvalidPlaylist:case Panopto.Core.ErrorCode.InvalidPlaylistUrl:this.showErrorMessage(Panopto.GlobalResources.Embed_InvalidPlaylist);break;case Panopto.Core.ErrorCode.InvalidPlaylistNoSessions:this.showErrorMessage(Panopto.GlobalResources.Embed_PlaylistHasNoViewableSessions);break;case Panopto.Core.ErrorCode.HasPendingMergeOrCopyJobs:this.showErrorMessage(Panopto.GlobalResources.Embed_HasPendingMergeOrCopyJobs);break;case Panopto.Core.ErrorCode.UnknownError:default:this.showErrorMessage(Panopto.GlobalResources.Embed_UnknownError)}},n.prototype.showErrorMessage=function(e){this.player.hide(),$("#errorMessageWrapper").show(),$("#errorMessage").text(e),$("#absoluteBackButton").toggle(this.hasBackButton)},n.prototype.showCallToAction=function(e){if($("#embed").addClass("is-call-to-action"),e.link){e.message=e.message||"{0}",e.link.target=e.link.target||"_self";var t=_.template($("#callToActionLinkTemplate").html())(e.link),o=String.format(e.message,t);$("#callToAction").html(o)}else $("#callToAction").text(e.message)},n.prototype.appendDiagnostics=function(e){$("#diagnostics").append(e).show()},n.prototype.requestAccess=function(){var e=this,t={deliveryId:this.deliveryId},o=function(){e.showCallToAction({message:Panopto.GlobalResources.Embed_RequestAccessFailure,link:{id:n.requestAccessLinkId,url:"#",text:Panopto.GlobalResources.Embed_RequestAccessFailureTryAgain}}),Panopto.Core.UI.Handlers.button($("#"+n.requestAccessLinkId),(function(){return e.requestAccess()}))};Panopto.Util.callWebMethod({methodName:"RequestAccess",serviceURL:Panopto.appRoot+"/Services/Data.svc",params:t,onSuccess:function(t){t?e.showCallToAction({message:Panopto.GlobalResources.Embed_RequestAccessSuccess}):o()},onFailure:function(){return o()},loadingIndicator:""})},n.prototype.configurePlaylistOverlay=function(t){var i=this;$("#overlay").addClass("playlist-mode");var a=!this.playlistAdvance;this.playlistOverlay=new e.Core.UI.Components.PlaylistOverlay($("#playlistOverlay"),$("#playlistButton"),this.playlistId,this.playlistDeliveryId,e.Core.UI.Components.PlaylistOverlaySkin.Embedded,{includeEmbedViewableOnly:!0},a,t&&!this.initParams.ErrorCode,new e.Core.API.Rest.PlaylistWithSessionsService),this.playlistOverlay.onPlayItem((function(e){if(e===i.deliveryId)i.initParams.ErrorCode||("pending"!==i.checkCopyrightNoticeRequirement.state()||i.copyrightNotice.isShowingNotice()||(i.initParams.ShowCopyrightNotice?i.copyrightNotice.showNotice(i.checkCopyrightNoticeRequirement.resolve):i.checkCopyrightNoticeRequirement.resolve()),i.flowplayer&&(i.flowplayer.splash?i.loadVideo():i.flowplayer.resume()),i.timelineController&&(i.player.hasClass("is-ready")?i.timelineController.resume():i.loadVideo()));else{var t=o.setQueryParameters(location.href,{pid:i.playlistId,id:e,advance:!0});location.replace(t)}}));var r=function(e){var t;i.menuOpen&&i.hideMenus(),i.eventOverlayShown&&i.toggleEventOverlay(!1),e?i.showControls(!1,{ignorePlayState:!0}):i.showControls(n.controlDisplayDuration),$("#embed").toggleClass("overlay-controls",!e),i.menuOpen=e,$("#appBackButton").toggle(!e&&i.hasBackButton),$("#title").toggle(!e&&i.showTitle),!(null===(t=i.flowplayer)||void 0===t?void 0:t.splash)&&i.player.hasClass("is-ready")||($("#logoContainer").toggle(!e),$("#playIconContainer").toggle(!e&&!i.isMobile),$("#splashPlayIconContainer").toggle(!e&&i.isMobile))};this.playlistOverlay.onToggle((function(e){return r(e)})),r(a),$("#playlistOverlay").on("click touchend",(function(e){return e.stopPropagation()}))},n.prototype.ensureMobileCompatibleManifest=function(e){var t=/_hlsbc/i.test(e),o=new RegExp(Panopto.viewer.mobileBroadcastUserAgentRegex,"i").test(navigator.userAgent);return this.isLiveBroadcast&&t&&o&&(e=e.replace("master.m3u8","master2.m3u8")),e},n.prototype.updateScormProgress=function(){var t=this;setInterval((function(){t.flowplayer?t.scormControl.updateProgress(t.flowplayer.video.time):t.timelineController&&t.scormControl.updateProgress(t.timelineState.timelinePosition)}),e.Viewer.Constants.TimedSyncRate)},n.prototype.enableUserSeek=function(){this.player.removeClass(n.seekDisabledClass),this.player.find(".fp-timeline").attr("tabindex",0)},n.prototype.preventUserSeek=function(){var e=this;if(this.player.addClass(n.seekDisabledClass),this.player.find(".fp-timeline").removeAttr("tabindex"),this.flowplayer&&$.browser.iphone){var t=this.videoElement.currentTime;this.videoElement.addEventListener("timeupdate",(function(){e.videoElement.seeking||(t=e.videoElement.currentTime)})),this.videoElement.addEventListener("seeking",(function(){e.videoElement.currentTime!==t&&e.nativeFullscreen&&(e.videoElement.currentTime=t)})),this.videoElement.addEventListener("ended",(function(){t=0}))}},n.hlsMimeType="application/x-mpegurl",n.mp4MimeType="video/mp4",n.rtmpMimeType="video/flash",n.captionsCookieKey="embedCaptions",n.volumeCookieKey="defaultEmbedVolume",n.maxVolume=100,n.requestAccessLinkId="requestAccessLink",n.defaultHeight=405,n.hoverCaptionsMinHeight=175,n.controlDisplayDuration=3e3,n.playDisplayDuration=500,n.playIconPulseDuration=750,n.quizSeekOffset=.5,n.controlButtonTabindex=2,n.portraitVideoAspectRatio=16/9,n.defaultCaptionScaling=2/3,n.minCaptionFontSize=16,n.maxCaptionFontSize=36,n.menus={playbackSpeed:{buttonSelector:"#playbackSpeedButton",menuSelector:"#playbackSpeedMenu"}},n.playbackSpeeds=PanoptoCore.mapEnum(PanoptoViewer.PlaySpeed,(function(e,t){return t})),n.clickedClass=Panopto.Core.Constants.ClickedClass,n.selectedClass=Panopto.Core.Constants.SelectedClass,n.quizLoadingClass="quiz-loading",n.seekDisabledClass="no-seek",n.flowplayerGlobal=flowplayer,n.flowplayerFlashSeekableIncrement=3,n.flowplayerFlashSeekableOffset=.25,n.CircularLogBufferSize=2048,n}();t.EmbeddedViewer=n}(e.Embed||(e.Embed={}))}(PanoptoTS||(PanoptoTS={})),function(e){!function(e){var t=PanoptoCore.VoidCallback,o=function(){function e(e,o){this.quiz=e,this._loadedCallback=new t,this.visible=!0,this.container=o.container,this.url=String.format(this.quiz.url,o.userId,o.invocationId)+"&embedded=true"}return Object.defineProperty(e.prototype,"loadedCallback",{get:function(){return this._loadedCallback},enumerable:!1,configurable:!0}),e.prototype.toggle=function(e){this.visible=e,this.iframe&&this.iframe.toggle(e)},e.prototype.render=function(){var t=this;this.iframe=$(e.template(this.quiz)).appendTo(this.container),this.iframe.toggle(this.visible),this.iframe.on("load",(function(){return t._loadedCallback.fire()})),this.iframe.prop("src",this.url)},e.prototype.remove=function(){this.iframe.remove()},e.template=_.template('<iframe class="quiz-player"></iframe>'),e}();e.QuizPlayer=o}(e.Embed||(e.Embed={}))}(PanoptoTS||(PanoptoTS={})),function(e){!function(e){var t=function(){function e(e){var t=void 0===e?{}:e,o=t.muted,i=void 0!==o&&o,a=t.playsInline,n=void 0!==a&&a,r=t.autoPlayRequested,s=void 0===r||r;this.muted=i,this.playsInline=n,this.autoPlayRequested=s}return e.prototype.detect=function(){var t=$.Deferred(),o=new RegExp(Panopto.viewer.autoPlayWhitelistRegex).test(navigator.userAgent),i=new RegExp(Panopto.viewer.autoPlayBlacklistRegex).test(navigator.userAgent);if(!this.autoPlayRequested||i)t.resolve(!1);else if(o)t.resolve(!0);else{var a=$('<video class="'+e.videoElementClass+'">').prependTo("body"),n=a[0];n.src=e.dummyMp4WithAudio,n.muted=this.muted,n.playsInline=this.playsInline;var r=n.play();"Promise"in window&&r instanceof Promise?r.then((function(){return t.resolve(!0)})).catch((function(e){return t.resolve(!1)})):t.resolve(!$.browser.mobile),t.then((function(){n.src="",n.load(),a.remove()}))}return t.promise()},e.videoElementClass="auto-play-detector",e.dummyMp4WithAudio="data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAC721kYXQhEAUgpBv/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3pwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcCEQBSCkG//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADengAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAsJtb292AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAALwABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAB7HRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAIAAAAAAAAALwAAAAAAAAAAAAAAAQEAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAAC8AAAAAAAEAAAAAAWRtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAAKxEAAAIAFXEAAAAAAAtaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAFNvdW5kSGFuZGxlcgAAAAEPbWluZgAAABBzbWhkAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAADTc3RibAAAAGdzdHNkAAAAAAAAAAEAAABXbXA0YQAAAAAAAAABAAAAAAAAAAAAAgAQAAAAAKxEAAAAAAAzZXNkcwAAAAADgICAIgACAASAgIAUQBUAAAAAAfQAAAHz+QWAgIACEhAGgICAAQIAAAAYc3R0cwAAAAAAAAABAAAAAgAABAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAIAAAABAAAAHHN0c3oAAAAAAAAAAAAAAAIAAAFzAAABdAAAABRzdGNvAAAAAAAAAAEAAAAsAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ni40MC4xMDE=",e}();e.AutoPlayDetector=t}(e.Viewer||(e.Viewer={}))}(PanoptoTS||(PanoptoTS={})),(Panopto=Panopto||{}).Core=Panopto.Core||{},Panopto.Viewer=Panopto.Viewer||{},Panopto.GlobalResources=Panopto.GlobalResources||{},function(e){!function(e){var t=function(){function e(){}return e.TimedSyncRate=30,e.ControlSyncRate=1e3,e.SecondarySyncThreshold=1,e.SecondarySynchronizingUpdateRateMillis=50,e.InitialSecondaryThreshold=5,e.SecondaryStreamOffset=1.5,e.MinSegmentGap=1,e.ContiguousSegmentThreshold=.2,e.EndPositionThreshold=.1,e.DeliveryRefreshInterval=6e4,e.DeliveryRefreshRetryCount=5,e.BroadcastEndedIncrement=5e3,e.ReopenedBroadcastInterval=3e4,e.QualityReportThreshold=2,e.BroadcastStreamRetryTimeout=5e3,e.LivePositionTolerance=1,e.BroadcastEndThreshold=1,e.MaxPositionInterpolation=500,e.BufferingTimeoutThreshold=1e3,e.BadSeekThreshold=.1,e.NativePositionFallbackRegion=1,e.CircularLogBufferSize=2048,e.SecondaryContentClass="secondary-content",e.SecondaryPlayerClass="secondaryPlayer",e.SlideDeckId="slideDeck",e.ScreenCaptureClass="screen-capture",e.ObjectVideoTabClass="object-video",e.UrlTabClass="url",e.TocIconClass="toc",e.YouTubeIconClass="youtube",e.SmartChapterIconClass="smart-chapter",e.SlideDeckTabClass="slide-deck",e.PrimaryTabHeaderClass="primary-header",e.SecondaryTabHeaderClass="secondary-header",e.RecentBroadcastThreshold=144e5,e.PlayKeyCode=32,e.RewindKeyCode=37,e.ForwardKeyCode=39,e.VolumeUpKeyCode=38,e.VolumeDownKeyCode=40,e.MuteKeyCode=77,e.VolumeIncrement=10,e.PositionIncrement=5,e.MinVolume=0,e.MaxVolume=100,e.InitialVolume=100,e.SilverlightVersion="4.0.50401.0",e.PlaySpeedSilverlightVersion="5.0",e.QuickRewindSeconds=10,e.QuickForwardSeconds=30,e.FullScreenControlInterval=3,e.EditJumpSeconds=5,e.CaptionMaxLength=384,e.TOCMaxLength=200,e.EditorTimelineEndOffsetSeconds=.01,e.DisplayTimePrecisionMultiplier=Math.pow(10,Panopto.Core.Constants.DisplayTimeMillisecondPrecision),e.UrlEventClosenessTolerance=.1,e.BoundaryCutTolerance=.1,e.StreamDeleteCutTolerance=.01,e.LeftPaneRatio=.35,e.LeftPaneMinWidth=460,e.RightPaneMinWidth=480,e.HeaderBuffer=60,e.MaxDesktopTitleCharacters=120,e.MaxMobileTitleCharacters=60,e.EventRegionMinHeight=300,e.PlayerMinHeight=50,e.LeftPlayerDefaultHeight=260,e.LiveNotesClass="live-notes",e.MaxInlineSecondaryTabs=3,e.CollapseSecondaryTabsWidth=1200,e.SliderDragThreshold=2,e.InputMargin=14,e.InputOptionsMargin=4,e.ScrollBarWidth=20,e.AudioOnlyMinimumWidth=2,e.ThumbnailScrollTimeout=5e3,e.EventScrollTimeout=5e3,e.FlyoutTimeout=2e3,e.MissingSeekedEventTimeout=5e3,e.BaseUrl=Panopto.uriScheme+"://"+Panopto.webServerFQDN+Panopto.appRoot,e.SessionListUrl=e.BaseUrl+"/Pages/Sessions/List.aspx",e.SilverlightEditorUrlTemplate=e.BaseUrl+"/Pages/Editor/Default.aspx#{0}",e.SlideImageUrl=e.BaseUrl+"/Pages/Viewer/Image.aspx",e.ThumbUrl=e.BaseUrl+"/Pages/Viewer/Thumb.aspx",e.DummyPDFUrl=e.BaseUrl+"/Scripts/PluginDetect/empty.pdf",e.FlashPlayerUrl="https://get.adobe.com/flashplayer",e.SinglePageAppUrl=Panopto.uriScheme+"://"+Panopto.webServerFQDN+Panopto.relativeSinglePageAppUrl,e.QuizEditUrlTemplate=e.SinglePageAppUrl+"quiz-configure/{0}",e.YouTubeEditUrlTemplate=e.SinglePageAppUrl+"youtubeEmbed/configure/{0}",e.HlsLevelFileNames=["index.m3u8","index2.m3u8"],e.JoinChannelOptionValue="joinChannel",e.SearchExpandDuration=400,e.FadeInterval=150,e.PlaySpeedResourceString="ViewerPlus_Speeds_{0}",e.BitrateResourcePrefixString="ViewerPlus_Bitrates_",e.BitrateResourceString=e.BitrateResourcePrefixString+"{0}",e.SearchTypeResourceString="ViewerPlus_Search_{0}",e.BitrateCookie="defaultBitrate",e.MBRBitrateCookie="defaultBitrateMBR",e.VolumeCookie="defaultVolume",e.CaptionsCookie="defaultCaptions",e.CaptionPlacementCookie="defaultCaptionPlacement",e.CaptionSizeCookie="defaultCaptionSize",e.CaptionColorCookie="defaultCaptionColor",e.BitrateLevels=[Panopto.GlobalResources[e.BitrateResourcePrefixString+"Low"],Panopto.GlobalResources[e.BitrateResourcePrefixString+"Medium"],Panopto.GlobalResources[e.BitrateResourcePrefixString+"Medium"],Panopto.GlobalResources[e.BitrateResourcePrefixString+"High"]],e.MaxScormSegments=100,e.ScormCompleteThreshold=.9,e.ScormOffsetMultiplier=5,e.ScormMaxUpdateDelay=30,e.ScormTimeKey="cmi.core.session_time",e.PluginDetectPDFReader="PDFReader",e.SortRelevanceValue="relevance",e.SortTimeValue="time",e.SearchSortOrders=[{value:e.SortRelevanceValue,name:Panopto.GlobalResources.ViewerPlus_SortByRelevance},{value:e.SortTimeValue,name:Panopto.GlobalResources.ViewerPlus_SortByTime}],e.MP4MimeType="video/mp4",e.HLSMimeType="application/x-mpegurl",e.Hive="Hive",e.Kollective="Kollective",e.KollectiveLongPollUrlBase="/api/v1/longpoll?ts={0}&ktoken=",e.LTIPage="/Panopto/LTI/LTI.aspx",e.OutcomeFormat="resultScore={0}&lis_result_sourcedid={1}&oauth_consumer_key={2}&lis_outcome_service_url={3}&lti_message_type=panopto_outcome_pox_response&lti_version=LTI-1p0",e}();e.Constants=t,function(e){e[e.High=2]="High",e[e.Medium=1]="Medium",e[e.Auto=0]="Auto"}(e.MBRBitrate||(e.MBRBitrate={})),function(e){e[e.Primary=1]="Primary",e[e.Secondary=2]="Secondary",e[e.LiveNotes=3]="LiveNotes"}(e.ViewMode||(e.ViewMode={}));var o=function(){function e(){}return e.getValues=function(e){return Object.keys(e).map((function(t){return e[t]})).filter((function(e){return!isNaN(e)}))},e.getNames=function(e){return Object.keys(e).map((function(t){return e[t]})).filter((function(e){return isNaN(e)})).map((function(e){return e.toString()}))},e.getNameValuePairs=function(e){return Object.keys(e).map((function(t){return new PanoptoCore.Models.KeyValue(t,e[t])})).filter((function(e){return!isNaN(e.value)}))},e}();e.EnumHelpers=o,function(e){e.HttpHeaders={Date:"date",LastModified:"last-modified"}}(t=e.Constants||(e.Constants={}))}(e.Viewer||(e.Viewer={}))}(PanoptoTS||(PanoptoTS={})),Panopto.Core.ViewerPlayState=Panopto.Core.ViewerPlayState||{},Panopto.Viewer.PlayState=function(e){return e.Playing=Panopto.Core.ViewerPlayState.Playing,e.Paused=Panopto.Core.ViewerPlayState.Paused,e.Stopped=Panopto.Core.ViewerPlayState.Stopped,e.Buffering=Panopto.Core.ViewerPlayState.Buffering,e}(Panopto.Viewer.PlayState||{}),function(e){!function(e){var t=PanoptoCore.Logging.Logger,o=function(){function o(i,a){var n=this;this.quizzes=i,this.ltiConfig=a,this.completedCallback=new PanoptoCore.TypedCallback,this.closedCallback=new PanoptoCore.TypedCallback,this.results={},this.isUpdatingResults=!1,this.onQuizCompleted=function(e){n.completedCallback.add(e)},this.onQuizClosed=function(e){n.closedCallback.add(e)},this.completeQuiz=function(e,t,o){var i=_.find(n.quizzes,(function(t){return t.id===e}));i&&(i.isSessionPlaybackBlocking=!1,n.ltiConfig&&n.recordResult(e,t,o),n.completedCallback.fire(i))},this.reportQuizResults=function(e,t,o){_.find(n.quizzes,(function(t){return t.id===e}))&&n.ltiConfig&&n.recordResult(e,t,o)},this.closeQuiz=function(e){var t=_.find(n.quizzes,(function(t){return t.id===e}));n.closedCallback.fire(t)},this.recordResult=function(o,i,a){if(_.isNumber(i)&&_.isNumber(a)){n.results[o]={correct:i,questions:a};var r=_.values(n.results);if(!_.contains(r,null)){var s=_.reduce(r,(function(e,t){return{correct:e.correct+t.correct,questions:e.questions+t.questions}})),l=Panopto.Core.StringHelpers.format(e.Constants.OutcomeFormat,s.correct/s.questions,n.ltiConfig.outcomeId,n.ltiConfig.oauthConsumerKey,n.ltiConfig.outcomeServiceUrl);n.isUpdatingResults=!0;var c=n.addAuthorizationHeader;PanoptoCore.TokenAuth.getStoredAuthToken().then((function(o){$.ajax({type:"GET",url:e.Constants.LTIPage,data:l,beforeSend:function(e){return c(e,o)},error:function(e){t.warning("Exception while performing an LTI page get in recordResult",e)}}).always((function(){n.isUpdatingResults=!1}))}))}}},o.instance=this,_.each(i,(function(e){n.results[e.id]=null})),$(window).on("beforeunload.quizResultsCheck",(function(){return n.isUpdatingResults||void 0}))}return o.getInstance=function(){return o.instance},o.prototype.addAuthorizationHeader=function(e,t){t&&e.setRequestHeader("Authorization","Bearer "+t)},o}();e.QuizResultsController=o}(e.Viewer||(e.Viewer={}))}(PanoptoTS||(PanoptoTS={})),function(e){!function(t){!function(t){var o=PanoptoCore.VoidCallback,i=function(){function t(e,t,i){this.blocked=e,this.signupUrl=t,this.resources=i,this._onDismiss=new o}return Object.defineProperty(t.prototype,"onDismiss",{get:function(){return this._onDismiss},enumerable:!1,configurable:!0}),t.prototype.render=function(){var o=this;this.dialogTitle=this.blocked?this.resources.QuotaDialog_OutOfHours:this.resources.QuotaDialog_TryPanopto,this.dialogSubTitle=this.blocked?"<div class='quota-dialog-subtitle-spacing'>"+this.resources.QuotaDialog_GetAccess+"</div>":"",this.panoptoLogo=e.ImageHelpers.getImageUrl("Header/Panopto_logo_2015.svg"),this.element=$(t.template(this)),this.blocked||Panopto.Core.UI.Handlers.button(this.element.find(".quota-dialog-close"),(function(){o._onDismiss.fire()}))},t.prototype.getElement=function(){return this.element},t.template=_.template("\n            <div class='quota-anonymous-dialog quota-dialog'>\n                <@ if (!blocked) { @>\n                    <div class='quota-dialog-close'>\n                        <div class='material-icons'>close</div>\n                    </div>\n                <@ } @>\n                <div class='quota-dialog-header'><img src='<@- panoptoLogo @>' /></div>\n                <div class='quota-dialog-title'>\n                    <hr />\n                    <div class='quota-dialog-title-text'>\n                        <@= dialogTitle @>\n                        <div class='quota-dialog-subtitle'><@= dialogSubTitle @></div>\n                    </div>\n                    <hr />\n                </div>\n                <div class='quota-dialog-feature-container'>\n                    <div class='quota-dialog-feature'>\n                        <div class='material-icons'>videocam</div>\n                        <div class='quota-dialog-feature-text'><@- resources.QuotaDialog_Record @></div>\n                    </div>\n                    <div class='quota-dialog-feature'>\n                        <div class='material-icons'>create</div>\n                        <div class='quota-dialog-feature-text'><@- resources.QuotaDialog_Edit @></div>\n                    </div>\n                    <div class='quota-dialog-feature'>\n                        <div class='material-icons'>share</div>\n                        <div class='quota-dialog-feature-text'><@- resources.QuotaDialog_Share @></div>\n                    </div>\n                    <div class='quota-dialog-feature'>\n                        <div class='material-icons'>search</div>\n                        <div class='quota-dialog-feature-text'><@- resources.QuotaDialog_Search @></div>\n                    </div>\n                    <div class='quota-dialog-feature'>\n                        <div class='material-icons'>lock</div>\n                        <div class='quota-dialog-feature-text'><@- resources.QuotaDialog_Privacy @></div>\n                    </div>\n                </div>\n                <div class='quota-dialog-buttons'>\n                    <a\n                        href='<@- signupUrl @>'\n                        target='<@- blocked ? \"_self\" : \"_blank\" @>'\n                        class='quota-dialog-button'\n                        onclick='Panopto.GoogleAnalytics.sendProSignupEvent(\"viewers-popup-click\");'\n                    >\n                        <@- resources.QuotaDialog_SignUp @>\n                    </a>\n                </div>\n                <div class='quota-dialog-bottom-padding'></div>\n            </div>\n        "),t}();t.AnonymousUserDialog=i}(t.QuotaPlaybackModalDialogs||(t.QuotaPlaybackModalDialogs={}))}(e.Controls||(e.Controls={}))}(PanoptoTS||(PanoptoTS={})),function(e){!function(t){!function(t){var o=function(){function t(e){this.resources=e}return t.prototype.render=function(){this.panoptoLogo=e.ImageHelpers.getImageUrl("Header/Panopto_logo_2015.svg"),this.element=$(t.template(this)),Panopto.Core.UI.Handlers.button(this.element.find(".upgrade-link-dialog"),(function(){Panopto.GoogleAnalytics.sendProUpgradeEvent(PanoptoCore.ProUpgradeActions.Open,PanoptoCore.ProUpgradeLabels.OpenFromOwner),Panopto.ProUpgradePopup()}))},t.prototype.getElement=function(){return this.element},t.template=_.template("\n            <div class='quota-owner-dialog quota-dialog'>\n                <div class='quota-dialog-header'><img src='<@- panoptoLogo @>' /></div>\n                <div class='quota-dialog-title'>\n                    <hr />\n                    <div class='quota-dialog-title-text'><@- resources.QuotaDialog_Title_Owner @></div>\n                    <hr />\n                </div>\n                <div class='quota-dialog-feature-container'>\n                    <@- resources.QuotaDialog_Instructions_Owner @>\n                </div>\n                <div class='quota-dialog-buttons upgrade-link-dialog'>\n                    <a class='quota-dialog-button'>\n                        <@- resources.QuotaDialog_Upgrade @>\n                    </a>\n                </div>\n                <div class='quota-dialog-bottom-padding'></div>\n            </div>\n        "),t}();t.OwnerDialog=o}(t.QuotaPlaybackModalDialogs||(t.QuotaPlaybackModalDialogs={}))}(e.Controls||(e.Controls={}))}(PanoptoTS||(PanoptoTS={})),function(e){!function(t){!function(t){var o=function(){function t(e){this.resources=e}return t.prototype.render=function(){this.panoptoLogo=e.ImageHelpers.getImageUrl("Header/Panopto_logo_2015.svg"),this.element=$(t.template(this))},t.prototype.getElement=function(){return this.element},t.template=_.template("\n            <div class='quota-viewer-dialog quota-dialog'>\n                <div class='quota-dialog-header'><img src='<@- panoptoLogo @>' /></div>\n                <div class='quota-dialog-title'>\n                    <hr />\n                    <div class='quota-dialog-title-text'><@- resources.QuotaDialog_Title_Viewer @></div>\n                    <hr />\n                </div>\n                <div class='quota-dialog-feature-container'>\n                    <@- resources.QuotaDialog_Instructions_Viewer @>\n                </div>\n                <div class='quota-dialog-bottom-padding'></div>\n            </div>\n        "),t}();t.ViewerDialog=o}(t.QuotaPlaybackModalDialogs||(t.QuotaPlaybackModalDialogs={}))}(e.Controls||(e.Controls={}))}(PanoptoTS||(PanoptoTS={})),function(e){!function(e){!function(t){var o=function(){function t(o,i,a,n,r,s,l,c,p,d,u,h,A,m,y,v){var g=this;this.deliveryId=o,this.tokenId=i,this.isEditing=a,this.isEmbed=n,this.isLiveNotes=r,this.refreshAuthCookie=s,this.overrideFQDN=l,this.uniqueViewerId=c,this.deliveryService=p,this.webcastVersionService=d,this.deliveryTransform=u,this.onDeliverySet=h,this.onDeliveryViewable=A,this.onBroadcastUpdated=m,this.onBroadcastReopened=y,this.onFatalError=v,this.webcastApiPermanentError=!1,this.retryCount=0,this.refreshDelivery=function(){var e;g.deliveryService.getDelivery(g.deliveryId,g.tokenId,null!==(e=g.invocationId)&&void 0!==e?e:g.delivery?g.delivery.invocationId:void 0,{refreshAuthCookie:g.refreshAuthCookie,isActiveBroadcast:g.isActiveBroadcast,isEditing:g.isEditing,isEmbed:g.isEmbed,isLiveNotes:g.isLiveNotes,overrideFQDN:g.overrideFQDN,uniqueViewerIdParam:g.uniqueViewerId},g.handleDeliverySuccess,g.handleDeliveryError)},this.refreshWebcastVersion=function(){g.webcastVersionService.getWebcastVersion(g.deliveryId,g.handleWebcastVersionSuccess,g.handleWebcastVersionError)},this.handleDeliverySuccess=function(o){g.retryCount=0;var i=g.delivery;g.delivery=g.deliveryTransform(o),i?g.delivery.isBroadcast&&!i.isBroadcast||g.isEmbed&&g.delivery.isBroadcast&&g.delivery.isViewable&&!i.isViewable?g.onBroadcastReopened(g.delivery):g.isEmbed||!g.delivery.isViewable||i.isViewable?g.isEmbed&&g.delivery.podcastCompleted&&!i.podcastCompleted?g.onDeliveryViewable(g.delivery):g.delivery.isViewable&&g.delivery.isBroadcast&&g.onBroadcastUpdated(g.delivery):g.onDeliveryViewable(g.delivery):g.onDeliverySet(g.delivery),g.webcastVersion=g.delivery.webcastVersionId,g.isActiveBroadcast=g.isActiveBroadcast||g.delivery.isBroadcast,g.delivery.isBroadcast?(g.refreshInterval=g.delivery.broadcastRefreshInterval,g.webcastApiRefreshInterval=g.delivery.webcastApiRefreshInterval):g.isEmbed||g.delivery.isViewable?g.isEmbed&&!g.delivery.podcastCompleted?(g.refreshInterval=g.refreshInterval?g.refreshInterval*=1.5:e.Constants.DeliveryRefreshInterval,g.refreshInterval=Math.min(g.refreshInterval,t.maxProcessingPingIntervalMsec),g.webcastApiRefreshInterval=void 0):g.delivery.isRecentBroadcast?(g.refreshInterval=e.Constants.ReopenedBroadcastInterval,g.webcastApiRefreshInterval=g.delivery.webcastApiRefreshInterval):(g.refreshInterval=void 0,g.webcastApiRefreshInterval=void 0):(g.refreshInterval=e.Constants.DeliveryRefreshInterval,g.webcastApiRefreshInterval=g.delivery.webcastApiRefreshInterval),g.setRefreshTimeout()},this.handleDeliveryError=function(t){!g.delivery||g.retryCount>=e.Constants.DeliveryRefreshRetryCount||t&&t.ErrorCode&&t.ErrorCode!==Panopto.Core.ErrorCode.UnknownError?g.onFatalError(t):(g.retryCount++,g.setRefreshTimeout())},this.handleWebcastVersionSuccess=function(e){g.webcastVersion!==e?g.callRefreshDelivery(g.webcastApiRefreshInterval):g.setRefreshTimeout()},this.handleWebcastVersionError=function(e,t,o){switch(e.status){case 404:g.callRefreshDelivery(g.webcastApiRefreshInterval);break;case 503:g.callRefreshDelivery(g.refreshInterval);break;default:g.webcastApiPermanentError=!0,g.callRefreshDelivery(g.refreshInterval)}},this.callRefreshDelivery=function(e){window.setTimeout(g.refreshDelivery,Math.floor(Math.random()*e))}}return t.prototype.start=function(){this.refreshDelivery()},t.prototype.stop=function(){window.clearTimeout(this.timeoutHandle)},t.prototype.resume=function(){this.setRefreshTimeout()},t.prototype.setInvocationId=function(e){this.invocationId=e},t.prototype.setRefreshTimeout=function(){this.webcastVersion&&this.webcastApiRefreshInterval&&!this.webcastApiPermanentError?this.timeoutHandle=window.setTimeout(this.refreshWebcastVersion,this.webcastApiRefreshInterval):this.refreshInterval&&(this.timeoutHandle=window.setTimeout(this.refreshDelivery,this.refreshInterval))},t.maxProcessingPingIntervalMsec=3e5,t}();t.DeliveryRefreshTimer=o}(e.Controls||(e.Controls={}))}(e.Viewer||(e.Viewer={}))}(PanoptoTS||(PanoptoTS={})),(Panopto=Panopto||{}).Viewer=Panopto.Viewer||{},Panopto.Viewer.ScormData=function(e,t){var o,i,a=PanoptoTS.Viewer.Constants,n=PanoptoCore.Logging.Logger,r=[],s=0,l=0,c=0,p=function(){return s/e>a.ScormCompleteThreshold};if(n.info(t),t&&(o=t.split("t"))[0].length===e){for(i=0;i<e;i++)r[i]=o[0].charAt(i),s+="x"===r[i]?1:0;c=parseFloat(o[1])||0}if(!r.length)for(i=0;i<e;i++)r[i]=" ";return{serialize:function(e){return r.join("")+"t"+e},markProgress:function(e){return e=Math.min(r.length,e),"x"!==r[e]&&(r[e]="x",s++,l++,!0)},segmentsWatched:function(){return s},completed:p,shouldUpdateSegments:function(e){return p()||l>=10||l*e>=a.ScormMaxUpdateDelay},shouldUpdatePosition:function(e,t,o,i){return Math.abs(e-t)>Math.min(a.ScormOffsetMultiplier*o,a.ScormMaxUpdateDelay)||e===i},lastPosition:function(){return c},onPositionUpdated:function(){l=0}}},Panopto.Viewer.ScormControl=function(e,t){var o,i=PanoptoTS.Viewer.Constants,a=PanoptoCore.Logging.Logger,n=Math.min(Math.ceil(t),i.MaxScormSegments),r=t/n,s=0,l=0,c=function(t){if(-1!==window.location.search.indexOf("scormlog=true")){var o=new Date;a.verbose("percentCompleted: "+t+" at time: "+o.getHours()+":"+o.getMinutes()+":"+o.getSeconds()+"."+o.getMilliseconds())}e.reportPercentCompleted(t)};try{var p=(o=Panopto.Viewer.ScormData(n,SD.GetBookmark())).lastPosition();p&&(e.position(p||0),l=p);var d=o.segmentsWatched();return s=d*r,c(100*p/t),{updateProgress:function(e){if(0!==e||0===l){var a=o.markProgress(Math.floor(e/r));if(a&&o.shouldUpdateSegments(r)||o.shouldUpdatePosition(e,l,r,t))try{SD.SetBookmark(o.serialize(e)),SD.LMSSetValue(i.ScormTimeKey,Math.floor(1e3*(o.segmentsWatched()*r-s))),a&&o.completed()&&SD.SetReachedEnd(),SD.CommitData(),o.onPositionUpdated(),l=e,c(100*e/t)}catch(e){}}}}}catch(e){}},Panopto.Viewer.Players=Panopto.Viewer.Players||{},function(e){!function(t){var o,i;o=t.Data||(t.Data={}),i=function(){function o(t){var o=Panopto.Viewer.Data,i=e.Viewer.Constants,a=t.Delivery.SessionName,n=Panopto.Core.TimeHelpers.formatWin32EpochTimeToDate(t.Delivery.SessionStartTime),r=t.Delivery.IsActiveBroadcast,s=t.Delivery.IsBroadcast&&t.Delivery.IsViewerEncodeComplete&&(new Date).getTime()-n.getTime()<=i.RecentBroadcastThreshold,l=this.parseStreams(t.Delivery.Streams,a,r),c=l.primaryStreams,p=l.secondaryStreams,d=l.activePrimary,u=l.screenCaptureStream,h=this.parsePlayerInfo(c,d,r),A=h.multiBitrateEnabled,m=h.playSpeedEnabled,y=h.flowPlayerEnabled,v=h.requiresSilverlight,g=this.parseEvents(t.Delivery.Timestamps,t.Delivery.EventTargets,t.Delivery.PublicNotesStreams,t.Delivery.Duration,u),f=g.slides,P=g.documents,b=g.thumbnails,C=g.contents,w=g.channels;this.title=a,this.id=t.Delivery.PublicID,this.webcastVersionId=t.Delivery.WebcastVersionId,this.date=n,this.duration=t.Delivery.Duration,this.description=t.Delivery.SessionAbstract,this.ownerId=t.Delivery.OwnerId,this.ownerFullName=t.Delivery.OwnerDisplayName,this.ownerBio=t.Delivery.OwnerBio,this.ownerIsOverQuota=t.Delivery.OwnerIsOverQuota,this.invocationId=t.InvocationId,this.embedUrl=t.EmbedUrl,this.downloadUrl=t.DownloadUrl,this.podcastCompleted=t.PodcastCompleted,this.broadcastRefreshInterval=1e3*t.BroadcastRefreshInterval,this.webcastApiRefreshInterval=1e3*t.WebcastPingIntervalInSeconds,this.broadcastSegmentBackoff=t.BroadcastSegmentBackoff,this.allowPublicNotes=t.AllowPublicNotes,this.hasAnyLinks=t.Delivery.HasAnyLinks,this.hasQuiz=t.Delivery.HasQuiz,this.firstQuizOffset=t.Delivery.FirstQuizOffset,this.hasCaptions=t.Delivery.HasCaptions,this.availableLanguages=t.Delivery.AvailableLanguages,this.isBroadcast=r,this.isViewable=r&&d||t.Delivery.IsViewerEncodeComplete,this.isReadyForEditing=t.Delivery.IsReadyForEditing,this.RehydrationAvailable=t.Delivery.RehydrationAvailable,this.isPurgedEncode=t.Delivery.IsPurgedEncode,this.isPurgedLegacyEncode=t.Delivery.IsPurgedLegacyEncode,this.requiresAdvancedEditor=t.Delivery.RequiresAdvancedEditor,this.broadcastEnded=t.Delivery.BroadcastEnded,this.broadcastInterrupted=t.Delivery.BroadcastInterrupted,this.isRecentBroadcast=s,this.isPrimaryAudioOnly=t.Delivery.IsPrimaryAudioOnly,this.requiresSilverlight=v,this.flowPlayerEnabled=y,this.multiBitrateEnabled=A,this.playSpeedEnabled=m,this.discussionEnabled=t.Delivery.DiscussionEnabled,this.discussionCacheSeconds=t.DiscussionCacheSeconds,this.lastViewingPosition=t.LastViewingPosition,this.completionPercentage=t.CompletionPercentage,this.normalizeVolume=t.Delivery.NormalizeVolume,this.activePrimary=d,this.primaryStreams=c,this.secondaryStreams=p,this.slideDecks=f.length?[o.SlideDeck(f)]:[],this.documents=P,this.thumbnails=b,this.captions=[],this.contents=C,this.channels=w,this.tags=t.Delivery.Tags,this.user={email:t.UserEmail,name:t.UserName,key:(t.UserKey||"").toLowerCase(),rating:t.UserRating,role:t.SessionRole,canCreateQuestionLists:t.UserCanCreateQuestionLists,permissions:t.Delivery.Permissions||[]},this.folder={name:t.Delivery.SessionGroupLongName,description:t.Delivery.SessionGroupAbstract,id:t.Delivery.SessionGroupPublicID},this.nextDelivery=void 0,t.Delivery.NextDeliveryUrl&&(this.nextDelivery={id:t.Delivery.NextDeliveryId,url:t.Delivery.NextDeliveryUrl,title:t.Delivery.NextDeliveryTitle,description:t.Delivery.NextDeliveryDescription,duration:Panopto.Core.TimeHelpers.formatDuration(t.Delivery.NextDeliveryDuration,Panopto.GlobalResources.TimeSeparator),thumbUrl:t.Delivery.NextDeliveryThumbUrl,isLive:t.Delivery.NextDeliveryIsLive,folderName:void 0}),this.serverModel=t}return o.prototype.parseStreams=function(e,o,i){var a=_.map(_.filter(e,(function(e){return"Archival"===e.StreamTypeName})),(function(e){return Panopto.Viewer.Data.Stream(e,i,o)})),n=(a=_.sortBy(a,"relativeStart")).length?i?_.find(a,(function(e){return!e.relativeEnd}))||_.max(a,(function(e){return e.relativeEnd})):a[0]:void 0,r=i?a:n?[n]:[],s=_.map(_.filter(e,(function(e){return"Archival"!==e.StreamTypeName})),(function(e){return Panopto.Viewer.Data.Stream(e,i,o)}));return{primaryStreams:r,secondaryStreams:s,activePrimary:n,screenCaptureStream:_.find(s,(function(e){return e.tabClass===t.Constants.ScreenCaptureClass}))}},o.prototype.parsePlayerInfo=function(e,o,i){var a=!!o&&_.contains(["ism","wmv"],o.fileType),n=!new RegExp(Panopto.features.hlsFlashFallbackRegex).test(navigator.userAgent)&&!Panopto.Core.Browser.isWin7IE11&&_.any(flowplayer.engines,(function(e){return"hlsjs"===e.engineName||"hlsjs-lite"===e.engineName})),r=Panopto.Core.Browser.supportsVideo(t.Constants.MP4MimeType),s=(!e.length||"hls"===o.fileType)&&n||(!e.length||"mp4"===o.fileType)&&r,l=Panopto.viewer.flowplayerEnabled&&!a&&s,c=!1;o&&(c="ism"===o.fileType||"hls"===o.fileType&&(l||Panopto.Core.Browser.flashEnabled()));var p=!1;return!i&&o&&(p=l||"mp4"===o.fileType&&r||"hls"===o.fileType&&o.httpUrl&&r||"wmv"===o.fileType&&!Panopto.Core.Browser.isWebkit),{multiBitrateEnabled:c,playSpeedEnabled:p,flowPlayerEnabled:l,requiresSilverlight:a}},o.prototype.parseEvents=function(t,o,i,a,n){var r=Panopto.Viewer.Data,s=_.filter(t,(function(e){return(e.Time||0===e.Time)&&e.Time<=a&&e.ObjectIdentifier&&e.ObjectSequenceNumber})),l=_.filter(s,(function(e){return"PowerPoint"===e.EventTargetType})),c=_.filter(s,(function(e){return e.Url})),p=[];_.each(c,(function(t){return p.push(new e.Viewer.Data.Document(t))})),_.each(o,(function(t){return p.push(new e.Viewer.Data.Document(t))}));var d=_.filter(s,(function(e){return!e.Url&&_.contains(["ObjectVideo","Primary","SmartOcrToc"],e.EventTargetType)})).concat(l);d.sort((function(e,t){return e.Time-t.Time}));var u,h=_.map(d,(function(t){return new e.Viewer.Data.Thumbnail(t,n)})),A=_.chain(d.concat(c)).unique().map((function(t){return new e.Viewer.Data.Event(t)})).filter((function(e){return!!jQuery.trim(e.text)})).value();return i&&(u=_.map(i,(function(e){return r.Channel(e,e,!0)}))),{slides:l,documents:p,thumbnails:h,contents:A,channels:u}},o}(),o.Delivery=i}(e.Viewer||(e.Viewer={}))}(PanoptoTS||(PanoptoTS={})),(Panopto=Panopto||{}).Viewer=Panopto.Viewer||{},Panopto.Viewer.Data=Panopto.Viewer.Data||{},Panopto.Viewer.Data.Stream=function(e,t,o){var i,a=[],n=[],r=e.Name||("SCREEN"===e.Tag?Panopto.GlobalResources.ViewerPlus_ScreenCaptureTitle:Panopto.GlobalResources.ViewerPlus_ObjectVideoTitle),s="SCREEN"===e.Tag?PanoptoTS.Viewer.Constants.ScreenCaptureClass:PanoptoTS.Viewer.Constants.ObjectVideoTabClass,l=function(e,o){var i=e-PanoptoTS.Viewer.Constants.SecondaryStreamOffset;return t||o&&i<=o+PanoptoTS.Viewer.Constants.MinSegmentGap?e:Math.max(0,i)};switch(e.RelativeSegments&&e.RelativeSegments.length?_.each(e.RelativeSegments,(function(e,t){var o=new PanoptoTS.Viewer.Data.SecondarySegment(e),i=n[t-1];o.timelineStart=l(o.relativeStart,i?i.relativeEnd:0),n.push(o),a.push(o.timelineStart,o.relativeEnd)})):(a.push(l(e.RelativeStart,void 0)),e.RelativeEnd&&a.push(e.RelativeEnd)),(i=PanoptoTS.Viewer.Data.ContentHelpers.createBaseContent(r,e.PublicID,s,a,e.AbsoluteStart,"","",!1,!1,!1,t,!1)).url=e.StreamUrl,i.httpUrl=e.StreamHttpUrl,i.fileType=e.ViewerMediaFileTypeName,i.relativeStart=e.RelativeStart,i.relativeEnd=e.RelativeEnd,i.length=e.RelativeEnd?e.RelativeEnd-e.RelativeStart:0,i.segments=n,i.interrupted=e.Interrupted,i.editFileType=e.EditMediaFileTypeName,i.deliveryTitle=o,i.broadcastSegmentDuration=e.BroadcastSegmentDuration,i.broadcastSegmentBackoff=e.BroadcastSegmentBackoff||Panopto.viewer.broadcastSegmentBackoff,i.vrType=e.VRType,Panopto.viewer.pureHlsJsPlayback&&i.vrType!==PanoptoViewer.MediaVRType.None&&(Panopto.Core.Browser.isSafari||Panopto.Core.Browser.isIE)&&(window.location.href=window.location.href+"&pureHlsJs=false"),e.Tag){case"AUDIO":i.type=Panopto.Core.ServiceInterface.Rest.Objects.StreamContentType.Audio,i.isAudioOnly=!0;break;case"SCREEN":i.type=Panopto.Core.ServiceInterface.Rest.Objects.StreamContentType.Screen,i.isAudioOnly=!1;break;default:i.type=Panopto.Core.ServiceInterface.Rest.Objects.StreamContentType.Camera,i.isAudioOnly=!1}return i.optimizationToken=e.OptimizationToken,i},function(e){!function(e){!function(e){var t=function(e){this.relativeStart=e.RelativeStart,this.relativeEnd=e.End?e.RelativeStart+(e.End-e.Start):1/0,this.streamOffset=e.Start};e.SecondarySegment=t}(e.Data||(e.Data={}))}(e.Viewer||(e.Viewer={}))}(PanoptoTS||(PanoptoTS={})),function(e){!function(e){!function(e){var t=function(){function e(){}return e.prototype.getStreamFriendlyType=function(){var e;switch(this.type){case Panopto.Core.ServiceInterface.Rest.Objects.StreamContentType.Audio:e=Panopto.GlobalResources.ViewerPlus_AudioTitle;break;case Panopto.Core.ServiceInterface.Rest.Objects.StreamContentType.Screen:case Panopto.Core.ServiceInterface.Rest.Objects.StreamContentType.Slide:e=Panopto.GlobalResources.ViewerPlus_ScreenCaptureTitle;break;case Panopto.Core.ServiceInterface.Rest.Objects.StreamContentType.Camera:default:e=Panopto.GlobalResources.ViewerPlus_ObjectVideoTitle}return e},e.prototype.getStreamName=function(){return this.name||this.getStreamFriendlyType()},e.convertFromApiModel=function(t){var o=new e;return o.id=t.id,o.url=t.url,o.httpUrl=t.httpUrl,o.absoluteStart=t.absoluteStart,o.duration=t.duration,o.thumbnailUrlBase=t.thumbnailUrlBase,o.thumbnailInterval=t.thumbnailInterval,o.type=t.type,o.vrType=t.vrType,o.name=t.name,o.iconCode=t.iconCode,o.absoluteEnd=t.absoluteEnd(),o.streamType=t.isPrimary?1:2,o.normalizeVolume=t.normalizeVolume,o},e}();e.Stream=t}(e.Data||(e.Data={}))}(e.Viewer||(e.Viewer={}))}(PanoptoTS||(PanoptoTS={})),function(e){!function(e){!function(e){var t=function(){function e(){}return e.getBlockingContent=function(e,t){return _.find(e,(function(e){var o=e.timeline[0];return e.isSessionPlaybackBlocking&&o<=t}))},e.getPausingContent=function(e,t,o){return _.find(e,(function(e){var i=e.timeline[0];return e.pauseWhenAvailable&&i>t&&i<=o}))},e}();e.ContentLogic=t}(e.Logic||(e.Logic={}))}(e.Viewer||(e.Viewer={}))}(PanoptoTS||(PanoptoTS={})),(Panopto=Panopto||{}).Viewer=Panopto.Viewer||{},Panopto.Viewer.Data=Panopto.Viewer.Data||{},Panopto.Viewer.Data.Channel=function(e,t,o){return{value:e,name:t||e,isUser:o}},(Panopto=Panopto||{}).Viewer=Panopto.Viewer||{},Panopto.Viewer.Data=Panopto.Viewer.Data||{},function(e){!function(e){!function(e){var t=function(){function e(){}return e.createBaseContent=function(e,t,o,i,a,n,r,s,l,c,p,d){var u=(i=i||[])[0];return{title:e,id:t,tabClass:o,iconClass:n,iconCode:r,timeline:i,relativeStartTime:u,absoluteStartTime:a=a||u,hiddenTab:s,pauseWhenAvailable:l,isSessionPlaybackBlocking:c,isBroadcast:p,isSecondaryPaneOnly:d}},e}();e.ContentHelpers=t}(e.Data||(e.Data={}))}(e.Viewer||(e.Viewer={}))}(PanoptoTS||(PanoptoTS={})),function(e){!function(t){!function(t){var o=function(){function t(e){var t=e.Url||e.URL;if(t){t=window.location.protocol+"//"+t.replace(/^.*?:\/\//,"")}var o="number"!=typeof e.Time,i=this.constructBaseObject(e,t,o);_.extend(this,i),this.url=t,this.isPdf=o,this.isQuiz=e.IsQuestionList}return t.prototype.constructBaseObject=function(t,o,i){var a=t.Caption||(t.FileName?decodeURIComponent(t.FileName):Panopto.GlobalResources.ViewerPlus_Website),n=t.ID||t.PublicId||t.PublicID,r=[];i?r.push(0):(r.push(t.Time),r.push(t.Time+PanoptoViewer.Constants.UrlEventDuration));var s=-1!==o.indexOf(PanoptoViewer.Constants.YouTubeEmbedBaseUrl),l=i?Panopto.Core.Constants.DocumentIconCode:t.IsQuestionList?Panopto.Core.Constants.QuestionListIconCode:s?void 0:Panopto.Core.Constants.LinkIconCode,c=s?e.Viewer.Constants.YouTubeIconClass:void 0;return e.Viewer.Data.ContentHelpers.createBaseContent(a,n,i?"pdf":e.Viewer.Constants.UrlTabClass,r,void 0,c,l,t.IsQuestionList,!i,t.IsSessionPlaybackBlocking,!1,!0)},t}();t.Document=o}(t.Data||(t.Data={}))}(e.Viewer||(e.Viewer={}))}(PanoptoTS||(PanoptoTS={})),function(e){!function(e){!function(e){var t=function(e){var t=e.EventTargetType||"UserCreatedTranscript",o=e.ID||e.EventID,i=o||e.PublicId!==Panopto.Core.Constants.EmptyGuid&&e.PublicId,a=i?"event"+i:(t+"-"+e.Time).replace(/\./gi,""),n=_.contains(["Transcript","UserCreatedTranscript"],t),r=_.contains(["ObjectVideo","Primary","PowerPoint","SmartOcrToc"],t),s=n?e.Data||e.Caption:r?e.Caption:e.Caption||e.Data,l=(e.UserName||"").toLowerCase(),c=t.replace(" ","");"Questions"===c&&(c="Comments"),this.id=a,this.eventId=o,this.eventPublicId=e.PublicId,this.sessionId=e.SessionID,this.time=e.Time,this.creationTime=e.CreationTime,this.text=s,this.user=l,this.userDisplayName=e.UserDisplayName||l,this.type=c,this.isQuestionList=e.IsQuestionList,this.saved=!0,this.createdDuringWebcast="Comments"===c&&e.CreatedDuringWebcast,this.url=e.Url};e.Event=t}(e.Data||(e.Data={}))}(e.Viewer||(e.Viewer={}))}(PanoptoTS||(PanoptoTS={})),(Panopto=Panopto||{}).Viewer=Panopto.Viewer||{},Panopto.Viewer.Data=Panopto.Viewer.Data||{},Panopto.Viewer.Data.Slide=function(e){return{time:e.Time,absoluteTime:e.AbsoluteTime,queryParams:{id:e.ObjectIdentifier,number:e.ObjectSequenceNumber,x:void 0}}},(Panopto=Panopto||{}).Viewer=Panopto.Viewer||{},Panopto.Viewer.Data=Panopto.Viewer.Data||{},Panopto.Viewer.Data.SlideDeck=function(e){var t=_.map(e,Panopto.Viewer.Data.Slide);t[0].time=0;var o=[t[0].time],i=PanoptoTS.Viewer.Data.ContentHelpers.createBaseContent(Panopto.GlobalResources.ViewerPlus_SlidesTitle,PanoptoTS.Viewer.Constants.SlideDeckId,PanoptoTS.Viewer.Constants.SlideDeckTabClass,o,t[0].absoluteTime,"","",!1,!1,!1,!1,!1);return i.slides=t,i},function(e){!function(e){!function(e){var t=function(){function e(){}return e.convertDeliveryToModel=function(e){return e.map((function(e){var t=new AutoClientModels.TagSearchItem;return t.content=e.Content,t.usageCount=e.UsageCount,t.id=e.PublicId,t}))},e}();e.TagHelper=t}(e.Data||(e.Data={}))}(e.Viewer||(e.Viewer={}))}(PanoptoTS||(PanoptoTS={})),function(e){!function(t){!function(t){var o=function(t,o){this.time=t.Time,this.text=t.Caption,this.queryParams={eventTargetPID:t.ObjectPublicIdentifier,sessionPID:t.SessionID,number:t.ObjectSequenceNumber,isPrimary:"Primary"===t.EventTargetType||"SmartOcrToc"===t.EventTargetType,absoluteTime:t.AbsoluteTime},this.isSlide="PowerPoint"===t.EventTargetType,t.ObjectStreamID!==Panopto.Core.Constants.EmptyGuid?this.tabId=t.ObjectStreamID:this.isSlide&&(this.tabId=o?o.id:e.Viewer.Constants.SlideDeckId)};t.Thumbnail=o}(t.Data||(t.Data={}))}(e.Viewer||(e.Viewer={}))}(PanoptoTS||(PanoptoTS={}));
//# sourceMappingURL=file://///seasyn/jenkinsbuilds/rel_rtc_11.0.6/11.0.6.00004/_PublishedWebsites/WebUI/Scripts/Panopto/Bundles/Embed.js.map
